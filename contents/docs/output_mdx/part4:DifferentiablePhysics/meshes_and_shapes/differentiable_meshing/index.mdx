# Differentiable Meshing \{#chap:differentiable_meshing\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:graphconvs\]](#chap:graphconvs)\{reference-type="ref+label"
reference="chap:graphconvs"\},
[\[chap:equivariant_networks\]](#chap:equivariant_networks)\{reference-type="ref+label"
reference="chap:equivariant_networks"\},
[\[chap:molecular_dynamics\]](#chap:molecular_dynamics)\{reference-type="ref+label"
reference="chap:molecular_dynamics"\},
[\[chap:dft\]](#chap:dft)\{reference-type="ref+label"
reference="chap:dft"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Many classical numerical methods rely on the construction of an explicit
mesh. The marching cubes algorithm, commonly used to construct such
meshes, is not natively differentiable. Recent work has revealed how to
use deep signed distance functions to create a differentiable
approximation to the marching cubes method that can be used to create
differentiable meshes [@remelli2020meshsdf], [@liu2020general]..

## The Marching Cubes Algorithm

The Marching cubes method from computer graphics provides a way to
extract a mesh from a provided 3D voxel dataset. The mesh is
mathematically represented by

$$\begin\{aligned\}
\mathcal\{M\} &= (V, F)
\end\{aligned\}$$ where $V$ is the set of vertices $$\begin\{aligned\}
V &= \{v_1, v_2, \dotsc \}
\end\{aligned\}$$ and $F$ represents the set of facets.

## Deep Signed Distance Functions

A signed distance function is a function $$\begin\{aligned\}
s: \mathbb\{R\}^3 \to \mathbb\{R\}
\end\{aligned\}$$ defined as $$\begin\{aligned\}
s(x) &= \begin\{cases\}
d(x, S) & x \textrm\{ outside \} S \\
-d(x, S) & x \textrm\{ inside \} S
\end\{cases\}
\end\{aligned\}$$

    def MeshSDFForward(z):
      assemble $G_\{3D\}$
      sample field $S = f_\theta(z, G_\{3D\})$
      extract $V, F = \textrm\{MarchingCubes\}(S, G_\{3D\})$
      return (V, F)

    def MeshSDFBackward():
      TODO
