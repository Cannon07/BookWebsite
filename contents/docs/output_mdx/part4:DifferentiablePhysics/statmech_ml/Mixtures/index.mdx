# Models for Mixtures \{#chap:ml_for_mixtures\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:mixtures\]](#chap:mixtures)\{reference-type="ref+label"
reference="chap:mixtures"\},\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Mixtures can have complex physics, since the compounds that constitute a
mixture interact with one another and each other in subtle ways. There
are interesting effects such as azeotropic mixtures, which are mixtures
that when boiling have vapor with the same fractional make-up as the
original mixture. This means techniques such as fractional distillation
(heating the mixture to a temperature at which some parts of the mixture
will vaporize while other parts won't) can't be used to separate out the
constituents of the mixture. Such physical effects demonstrates how a
mixture can have interesting macroscopic physics that's more than the
sum of its parts.

Physical descriptors are often used to predict properties of single
compounds. However many substances are not single compounds but rather
mixtures. Fuel as used for cars is commonly a complex mixture of
hydrocarbons for example. In this chapter, we study the problem of
predicting the flash points of mixtures. The flash point is the
temperature of vapor ignition above a volatile liquid. Being able to
predict the flash point would be important for safety while
experimenting with new mixtures especially when working with
petrochemicals.

## Feature Engineering for Mixtures

One approach models binary mixtures by combining descriptors for the
constituent compounds according to their mole fractions. A related
approach uses a mole-fraction weighted average values of mixture
descriptors along with a genetic algorithm and multilinear regression to
make the actual prediction. Such models have been used to predict things
like the densities and infinite dilution activity quotients of binary
mixtures. Other work has tried to predict things like the boiling points
of azeotropic binary mixtures

## Compound Descriptors

Descriptors can be computed by using density functional to obtain low
energy structures. 300 molecular descriptors were computed from these
structures. These were split into 4 categories of descriptors

1.  **Constitutional descriptors**: identification and count of specific
    features of the molecule

2.  **Topological descriptors**: descriptions of the 2D structure of the
    molecule.

3.  **Geometric descriptors**: descriptions of the 3D shape of the
    molecule

4.  **Quantum chemical descriptors**: binding, energetic, electronic,
    thermodynamic information

## Mixture Descriptors

Mixture descriptors $D$ were computed by taking the molecular
descriptors $d_i$ of each component, taking into account their
respective mole fractions $x_i$.

$$\begin\{aligned\}
D &= f(d_i, x_i) 
\end\{aligned\}$$

The flash point of mixtures is not a simple linear combination effect of
substituent molecules;. Rather, there are complex interactions between
compounds involving their relative affinities and respective vapor
pressures.

## Direct Combinations

All of these proposed formulas are symmetric with respect to molecular
descriptors and mole fractions. Mathematically put, that means

$$\begin\{aligned\}
D &= f(d_1, x_1, d_2, x_2) = f(d_2, x_2, d_1, x_1)
\end\{aligned\}$$

A second conserved property is that if the mole fraction of one compound
drops to zero, the descriptor should cease to depend on that compound.
Stated in equations

$$\begin\{aligned\}
D &= f(d_2, x_2) \textrm\{ if \} x_1 = 0 
\end\{aligned\}$$

The simplest formula is a weighted linear combination.

$$\begin\{aligned\}
D_\{\textrm\{sum\}\} &= x_1 d_1 + x_2 d_2 
\end\{aligned\}$$

An alternate is the weighted absolute difference

$$\begin\{aligned\}
D_\{\textrm\{diff\}\} = | x_1 d_1 - x_2 d_2| 
\end\{aligned\}$$

Other variants are the square mole fraction and square-root mole
fraction

$$\begin\{aligned\}
D_\{\textrm\{square\}\} &= x_1^2 d_1 + x_2^2 d_2 \\
D_\{\textrm\{root\}\} &= \sqrt\{x_1\} d_1 + \sqrt\{x_2\} d_2 
\end\{aligned\}$$

Another alternatives are the square molar contribution and the norm of
the molar contribution

$$\begin\{aligned\}
D_\{\textrm\{square-molar\}\} &= (x_1 d_1 + x_2 d_2)^2 \\
D_\{\textrm\{norm\}\} &= \sqrt\{(x_1d_2)^2 + (x_2 d_2)^2\} 
\end\{aligned\}$$

## Deviation Combinations

These combinations depend on the differences

$$\begin\{aligned\}
\Delta d &= |d_2 - d_1| \\
\Delta x &= |x_2 - x_1| 
\end\{aligned\}$$

The first deviation combination we consider is the molar deviation

$$\begin\{aligned\}
D_\{\textrm\{dev\}\} &= (1 - \Delta x) \Delta d 
\end\{aligned\}$$

Here are two other variants respectively called square molar deviation
and molar deviation squared.

$$\begin\{aligned\}
D_\{\textrm\{square-dev\}\} &= (1 - (\Delta x)^2) \Delta d \\
D_\{\textrm\{dev-square\}\} &= (1 - \Delta x)^2 \Delta d 
\end\{aligned\}$$

Here are some other variant contribution formulas to consider such as
the centroid

$$\begin\{aligned\}
D_\{\textrm\{centroid\}\} &= \frac\{\sum_i d_i\}\{n\} 
\end\{aligned\}$$

where $n$ is the number of compounds in the mixture. Two other formulas
are squared difference and the absolute difference

$$\begin\{aligned\}
D_\{\textrm\{sqr-diff\}\} &= (d_1 - d_2)^2 \\
D_\{\textrm\{abs-diff\}\} &= |d_1 - d_2| 
\end\{aligned\}$$

## Models Considered

To start we train simple multilinear regression models such as

$$\begin\{aligned\}
Y = \sum_i a_i D_i + a_0 
\end\{aligned\}$$

Where $D_i$ are the mixture descriptors. A heuristic pruning method can
be used to prevent overparameterization and ensure that the multilinear
regression didn't have too many terms.
