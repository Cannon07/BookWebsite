# Free Energy Perturbation \{#chap:fep\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:newtons_laws\]](#chap:newtons_laws)\{reference-type="ref+label"
reference="chap:newtons_laws"\},
[\[chap:electrostatics\]](#chap:electrostatics)\{reference-type="ref+label"
reference="chap:electrostatics"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Free energy perturbation techniques allow for estimates of the
differences in free energy between different states of a physical
system. Free energy perturbation systems can be critically important for
computing quantities like the binding free energy of a molecule to a
protein.

## Theoretical Foundations

Suppose that we have two states of interest, state $0$ and state $1$.
Let $A$ be the Helmholtz free energy. We can estimate the free energy
state difference between state $0$ and $1$ by only drawing samples from
state $0$ and then computing the potential energies for states $1$ and
$0$, and then compute the estimated free energy difference using the
update formula

$$\begin\{aligned\}
\Delta A &= A_1 - A_0 \\
&= -k_B T \ln \left \langle \exp \left (  -\frac\{U_1 - U_0\}\{k_B T\} \right ) \right \rangle
\end\{aligned\}$$ Here $U_1$ and $U_0$ are the potential energies of
states $1$ and $0$ respectively. The challenge in using this equation
though is that often state $1$ and state $0$ are far enough apart that
computing the estimate directly from state $0$ can be prohibitively
challenging. For this reason, the path from $0$ to $1$ is typically
broken into a series of steps controlled by a parameter traditionally
called $\lambda$.

## Targeted Approaches

A new class of techniques seeks to make computations easier by learning
a transformation that maps states $0$ and $1$ into overlapping regions.
This learned transformation is typically a normalizing flow.
