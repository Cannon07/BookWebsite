# Phonon Density Prediction \{#chap:phonon_density\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:phonons\]](#chap:phonons)\{reference-type="ref+label"
reference="chap:phonons"\},
[\[chap:molecular_ml\]](#chap:molecular_ml)\{reference-type="ref+label"
reference="chap:molecular_ml"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Phonons play a critical role in condensed matter science, and are
powerful tools to model phenomena such as nanoscale heat transport. The
phonon density of states $D(\omega)$ is a core materials property linked
to a number of physical properties of materials including specific heat,
thermal resistance, potential for superconductivity and more. Existing
computational techniques struggle to effectively model this property and
are either brittle or expensive.

We can use machine learning methods to direct predict phonon density of
states directly from molecular structure [@chen2021direct]. Low data
availability means that exploiting equivariance becomes crucial for
achieving performant behavior.

## Featurization

Crystal structures are converted into periodic graphs where atoms are
nodes and edges connect atoms within a specified distance. Edge $e_\{ab\}$
is a scalar which represents the distance between atoms $a$ and $b$.
Atomic features are one hot encodings of atomic type and mass. The
feature vector for hydrogen is given by $$\begin\{aligned\}
    x_H &= [m_H,0,0,\dotsc] \\
    x_\{Li\} &= [0, 0, m_\{Li\},0,\dotsc]
\end\{aligned\}$$

## Model Construction

Equivariant models are constructed to process the periodic graphs and
predict phononic density.

Models are trained to predict phonon density of states, a flat vector
and are trained on the mean squared loss against DFT data. A diagram of
the architecture is shown below

![An equivariant architecture for phonon density
prediction.](figures/Differentiable Physics/Materials ML/Phonon Density Prediction/phonon_den_pred.png)\{#fig:enter-label\}

## Materials Design Applications

A phonon density prediction model can be used to facilitate materials
design. The phononic specific heat capacity is given by the formula

$$\begin\{aligned\}
C_V(T) &= \frac\{k_B\}\{m_\{tot\}\} \int_0^\infty \left ( \frac\{\hbar \omega\}\{2 k_B T\} \right )^2 \mathrm\{csch\}^2 \left (\frac\{\hbar \omega\}\{2 k_B T\} \right ) g(\omega) d\omega
\end\{aligned\}$$ Here $m_\{tot\}$ is the mass of all atoms inside the unit
cell, and $g(\omega)$ is the normalized phonon density of states.
Predicted $g(\omega)$ values can be plugged into this formula to design
high specific heat materials.
