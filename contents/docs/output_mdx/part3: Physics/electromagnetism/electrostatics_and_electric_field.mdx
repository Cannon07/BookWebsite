# Electrostatics and the Electric Field \{#chap:electrostatics\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:newtons_laws\]](#chap:newtons_laws)\{reference-type="ref+label"
reference="chap:newtons_laws"\},\
**Difficulty Level:** \*\

------------------------------------------------------------------------

In this chapter we introduce the basics of electrostatics, the study of
charged particles at rest. We also introduce the important notion of the
electric field, a powerful abstraction which will enable us to reason
more effectively about systems of charged particles.

## A Point Particle

The starting point of electromagnetism is the idea of \"charge.\" Charge
is a property of certain types of matter and can be positive, negative,
or zero, and the presence of charge induces a concomitant force.
*Coulomb's law* provides the fundamental equation governing charged
systems. Suppose we have two charged particles with charges $q_1$ and
$q_2$ at distance $r$ from one another. These charges exert a force on
one other with magnitude $$\begin\{aligned\}
    \|\vec\{F\} \| = \frac\{1\}\{4 \pi \epsilon_0\} \frac\{q_1q_2\}\{r^2\}
    \label\{eqn:coulomb_law\}
\end\{aligned\}$$ where $\epsilon_0$ is a physical constant. This force is
attractive if the forces have the same charge or repulsive otherwise.
You might note here that this law has the same rough form as Newton's
gravitational law.

Let us suppose that charges $q_1$ and $q_2$ are at positions
$\vec\{x\}_1, \vec\{x_2\}$ and write down the force that is exerted on $q_2$
explicitly

$$\begin\{aligned\}
\vec\{F\}_\{12\} = \frac\{1\}\{4 \pi \epsilon_0\} \frac\{q_1q_2\}\{\|\vec\{x_1\} - \vec\{x_2\}\|\} \frac\{\vec\{x_2\}-\vec\{x_1\}\}\{\|\vec\{x_1\} - \vec\{x_2\}\|\}
\end\{aligned\}$$

Note that $\vec\{F\}_\{12\}$ has type $\mathbb\{R\}^3$. Here is a simple
differentiable program that implements this force calculation
explicitly.

``` \{.python language="python"\}
$\epsilon_0$: $\mathbb\{R\}$ # Constant
def coulomb(q1: $\mathbb\{R\}$, q2: $\mathbb\{R\}$, x1: $\mathbb\{R\}^3$, x2: $\mathbb\{R\}^3$) -> $(\mathbb\{R\}^3, \mathbb\{R\}^3)$:
  Fmag = (1 / (4 * $\pi$ * $\epsilon_0$)) * (q1 * q2 / $\| \textrm\{x1\} - \textrm\{x2\} \|^2$))
  return (Fmag * (x2 - x1)/$\| \textrm\{x1\} - \textrm\{x2\} \|$, Fmag * (x1 - x2)/$\| \textrm\{x1\} - \textrm\{x2\} \|$)
```

This program computes the forces on both $q_1$ and $q_2$ and returns
them both. Since the type of a force is $\mathbb\{R\}^3$, the return type
we get here is a tuple $(\mathbb\{R\}^3, \mathbb\{R\}^3)$. Read through this
function and make sure you can convince yourself this is a faithful
implementation of Coulomb's law. Note that one advantage of this
formulation is that $\epsilon_0$ is now a free parameter that can be
learned from data.

Suppose that we have one charge $q_1$ at a position $x_1$ in space.
Let's suppose that have another charge $q_2$ elsewhere in space. Note
that we can write the force equation with $q_2$ factored out as

$$\begin\{aligned\}
    \vec\{F\}_\{12\} = \left (\frac\{1\}\{4 \pi \epsilon_0\} \frac\{q_1\}\{\|\vec\{x_1\} - \vec\{x_2\}\|^2\} \frac\{\vec\{x_2\}-\vec\{x_1\}\}\{\|\vec\{x_1\} - \vec\{x_2\}\|\} \right) q_2
\end\{aligned\}$$

Note that the quantity in parentheses only depends on the location in
space $\vec\{x_2\}$. It's common to denote this quantity as the electric
field $\vec\{E\}$.

$$\begin\{aligned\}
    \vec\{E\}(\vec\{x\}) &= \frac\{1\}\{4 \pi \epsilon_0\} \frac\{q_1\}\{\|\vec\{x_1\} - \vec\{x_2\}\|^2\} \frac\{\vec\{x\}-\vec\{x_1\}\}\{\|\vec\{x\} - \vec\{x_2\}\|\} 
\end\{aligned\}$$

The electric field $\vec\{E\}$ is a function that assigns to every point
in space a vectorial quantity. Given this definition, we can simplify
our earlier force definition as $$\begin\{aligned\}
    \vec\{F\}_\{12\} &= \vec\{E\}(x_2) q_2
\end\{aligned\}$$

The type of the electric field is given by

    $\vec\{E\}$ : $\mathbb\{R\}^3 \to \mathbb\{R\}^3$

That is, the electric field is naturally a function type. It's the first
basic physical quantity we've defined that naturally has this type.
Mathematically, we can also say that the electric field is a vector
field and alternatively write its type as

    $\vec\{E\}$ : $\mathbb\{R\}^3 \to \mathrm\{T\} \mathbb\{R\}^3$

These two types are identical since the tangent space of $\mathbb\{R\}^3$
can be identified with $\mathbb\{R\}^3$. We can define a simple
differentiable program to compute the electric field of a point particle
as follows.

    def E(q1: $\mathbb\{R\}$, x1: $\mathbb\{R\}^3$, x: $\mathbb\{R\}^3$) -> $\mathbb\{R\}^3$:
      ((1 / (4 * $\pi$ * $\epsilon_0$)) * (q1 * q2 / $\| \textrm\{x\} - \textrm\{x1\} \|^2$)) 
               * (x - x1)/$\| \textrm\{x\} - \textrm\{x1\} \|$)

Oftentimes it's natural to think about the electric field as the more
basic object than any explicit force. The reason is that given the
electric field, we can compute forces for many different choices of
other point charges.

How can we measure the electric field due to a point particle? We
suppose that we have a small charge $dq$ at $x'$ whose charge is known
(we choose a small charge so the reciprocal force on $q$ is negligible).
Suppose also that we can measure the force $\vec\{F\}$ on $dq$ directly,
but with Gaussian error that has bias $b \in \mathbb\{R\}^3$ and some
standard deviation $\sigma$. That is we measure $$\begin\{aligned\}
\vec\{F\}_\{dq\}(x') + \mathcal\{N\}(b, \sigma^2)
\end\{aligned\}$$ If we divide through by $dq$, we then obtain the
following approximate error for the electric field (remember the scaling
rule for Normal distributions is that multiplying by a constant scales
the variance by the constant squared)

$$\begin\{aligned\}
    \vec\{E\}(x') + \mathcal\{N\}\left (b, \frac\{\sigma^2\}\{dq^2\} \right)
\end\{aligned\}$$

Let's write down a differentiable program that samples a measurement of
the electric field for a given point particle $q$ at
$x \in \mathbb\{R\}^3$

    def measure(q: $\mathbb\{R\}$, dq: $\mathbb\{R\}$, x: $\mathbb\{R\}^3$, x': $\mathbb\{R\}^3$, b: $\mathbb\{R\}^3$, $\sigma$: $\mathbb\{R\}^3$) -> $\mathbb\{R\}^3$:
      return E($\epsilon_0$, q, x, x') + Normal(b, $\sigma^2$/$\textrm\{dq\}^2$)

Let's suppose that we now have a dataset of experimental measurements of
the field generated by a charge $q$ at $x \in \mathbb\{R\}^3$. Suppose
that our test charge is $dq$ and we've measured at $x_1, \dotsc, x_n$
and obtained experimental field measurements $E_1, \dotsc, E_n$. Let's
see how we could then learn the value of parameter $\epsilon_0$ from
this dataset. Let's first write down a model for the generation of the
experimental dataset.

    def gen(N: $\mathbb\{N\}$, q: $\mathbb\{R\}$, $dq$: $\mathbb\{R\}$, $x$: $\mathbb\{R\}^3$, [$x_i$]: $\mathbb\{R\}^\{3n\}$, b:$\mathbb\{R\}^3$, $\sigma$: $\mathbb\{R\}^3$) -> $\mathbb\{R\}^\{3n\}$:
      return [measurement(q, dq, x, xi, b, $\sigma)$ for xi in [$x_i$]]

Let's suppose that we know $b, \sigma$ for simplicity. Then we can write

    $\overline\{\epsilon_0\}$ = Optimize(gen, [$E_i$], $\epsilon_0$)

We have successfully taken the physical theory and transformed it into a
simple effective computation for learning basic physical constants like
$\epsilon_0$ from experimental measurements.

## Electrostatic Potential Energy

In this section, we introduce a notion of potential energy for point
charges. The *electrostatic potential energy* of a point charge with
charge $q$ at distance $r$ from another point charge with charge $Q$ is
given by $$U(r) = \frac\{1\}\{4\pi \epsilon_0\} \frac\{qQ\}\{r\}$$ The type of
$U$ is given by

    U: $\mathbb\{R\}^+ \to \mathbb\{R\}$

The basic idea here is the same as that for gravitational potential
energy. The potential energy difference between two points tracks the
work that is needed to move between them. Recall that the work-potential
energy equation is given by

$$\begin\{aligned\}
    W_\{a\to b\} = \int_\{C\} \vec\{F\}(x) \cdot dx
\end\{aligned\}$$

where $C$ is any trajectory between two points $a$ and $b$. Note that
$W_\{a\to b\}: \mathbb\{R\}$. For the case of electrostatic potential
energy, we want to take one of these points to be infinitely far away,
to be a reference point with zero energy. Put fancifully
$$\begin\{aligned\}
    U(r) &= \int_C \vec\{E\}(\vec\{x\}) \cdot dx \\
    &= W_\{\infty \to r\} 
\end\{aligned\}$$

## Multiple Point Particles

Let's now look at a more complex system. Consider a collection of $N$
particles each of which has charge $q_i$ and is located at location
$\vec\{x_i\}$. These particles create an electric field $E$ which extends
throughout space. Formally, the electric field is a function
$\mathbb\{R\}^3 \to \mathbb\{R\}^3$ defined as

$$\vec\{E\}(\vec\{r\}) = \frac\{1\}\{4 \pi \epsilon_0\} \sum_\{i=1\}^N \frac\{q_i\}\{\|\vec\{r\} - \vec\{x_i\}\|^2\}  \frac\{\vec\{r\}-\vec\{x_i\}\}\{\|\vec\{r\} - \vec\{x_i\}\|\}$$

We can turn this into a differentiable program simply as follows

    def E($n$: $\mathbb\{N\}$, [$q_i$]: $\mathbb\{R\}^n$, [$x_i$]: $\mathbb\{R\}^\{3n\}$, x: $\mathbb\{R\}^3$) -> $\mathbb\{R\}^3$:
      return sum([E($\epsilon_0$, qi, xi, x) 
                  for (qi, xi) in zip([$q_i$], [$x_i$])])

Note that the electric field is a vector field. Now suppose that we have
a new particle at $\vec\{u\}$ with charge $q$. We can compute the force
from the electric field as before with the equation

$$\vec\{F\}(\vec\{u\}) = \vec\{E\}(\vec\{u\}) q$$

The challenge here is that all particles exert forces on each other, so
the dynamics of a multibody electrostatic system can grow complex very
quickly. Let's try to write down a formal physical theory for this
system and transform it into series of associated differentiable
programs.

What's the state space $\mathcal\{S\}$? Conceptually, we have to \"glue
together\" the states spaces for $n$ point charges. A static point
charge $q$ with mass $m$ lives at a position in $\mathbb\{R\}^3$. We know
from before that we treat charge $q$ as a parameter. Is $\mathbb\{R\}^3$ a
sufficient state space for a point charge? Not if we want allow the
point charge to move. In that case, we also want to track the velocity
of the point charge. Note that we don't need to know the acceleration of
the point charge since we can compute the force on any given point
charge using Coulomb's law and back out the acceleration from Newton's
laws. This suggests each particle has a state in $\mathbb\{R\}^6$ and that
the full system has state space $\mathbb\{R\}^\{6n\}$.

What are the parameters for our system? Well each point charge has a
mass $m_i \in \mathbb\{R\}^+$ and a charge $q_i \in \mathbb\{R\}$. In
addition, each point charge has initial conditions
$\vec\{x_i\}(0) \in \mathbb\{R\}^3$ and $\vec\{v_i\}(0) \in \mathbb\{R\}^3$. We
can put all these together and say that the parameter space is

$$\begin\{aligned\}
    \mathcal\{W\} &= (\mathbb\{R\}^+, \mathbb\{R\}, \mathbb\{R\}^3, \mathbb\{R\}^3)^n
\end\{aligned\}$$

Let's now think about symmetries the system has to satisfy. There's no
friction or radiation or other mechanisms to \"leak\" energy, so we must
have that the energy of the system is conserved. We know that particles
can have kinetic energy and potential energy. What's the total energy
for a given particle at time $t = 0$? We can write it down as

$$\begin\{aligned\}
    E_i = \frac\{1\}\{2\}m_i \|\vec\{v_i\}(0)\|^2 + \frac\{1\}\{4\pi \epsilon_0\} \sum_\{j \neq i\} \frac\{q_iq_j\}\{\|\vec\{x_i\} - \vec\{x_j\}\|\}
\end\{aligned\}$$

The first term is the kinetic energy for particle $i$. The second term
computes the potential energy of particle $i$ with respect to every
other particle $j$ and sums up these contributions. The total energy of
the system is then simply

$$\begin\{aligned\}
E &= \sum_\{i=1\}^n E_i \\
  &= \sum_\{i=1\}^n \left (\frac\{1\}\{2\} m_i \|\vec\{v_i\}(0)\|^2 + \frac\{1\}\{4\pi\epsilon_0\}\sum_\{j \neq i\} \frac\{q_iq_j\}\{\|\vec\{x_i\} - \vec\{x_j\}\|\} \right )
\end\{aligned\}$$

This quantity $E$ is conserved through the time evolution of the system.
We also know that momentum and angular momentum are conserved for this
system but we will leave the details to the reader.

Let's now turn to the problem of of computing the time evolution of this
system. In previous chapters we've seen how to use Newton's equations to
compute the time evolution of moving particles. We can use this same
strategy in principle to solve for the time evolution of this system. By
Newton's laws, the acceleration on the $i$-th particle in the system is
given by the equation $\vec\{a_i\} = \frac\{1\}\{m_i\} \vec\{F_i\}$ where the
force $F_i$ on particle $i$ is given by $$\begin\{aligned\}
\vec\{F_i\} = \frac\{1\}\{4 \pi \epsilon_0\} \sum_\{j \neq i\} \frac\{q_iq_j\}\{\|\vec\{x_i\} - \vec\{x_j\}\|^2\} \frac\{\vec\{x_i\} - \vec\{x_j\}\}\{\|\vec\{x_i\} - \vec\{x_j\}\|\}
\end\{aligned\}$$ This leads to time evolution equations $$\begin\{aligned\}
\vec\{U\}(t) = \vec\{x\}(0) + \int_0^t \vec\{v\}(0) + \left (\int_0^v \frac\{\vec\{F_i\}\}\{m\}(u) du \right ) dv
\end\{aligned\}$$ Superficially, these equations are very similar to those
we saw earlier for a particle moving under the effect of gravity on the
surface of the earth. However, the function we are integrating over is
dramatically more complex than it was previously! The reality is that in
most cases we hold no real ability to analytically integrate these
equations. However, we can very reasonably still write a differentiable
program for the system.

Note furthermore that the equations we have defined are vectorial
equations. It isn't possible to integrate for $\vec\{x\}_i$ by itself
since the force on the $i$-the particle depends on the positions of all
the other particles in the system.

    def U([$q_i$]: $\mathbb\{R\}^n$, [$x_i(0)$]: $\mathbb\{R\}^\{3n\}$, [$v_i(0)$]: $\mathbb\{R\}^\{3n\}$) -> $\mathbb\{R\}^\{6n\}$:
      return $x_i$ + Integrate($v_i$ + Integrate($q_i$*E(...), 0, v), 0, t)

As always there are some restrictions to the domain of applicability of
our physical theory. First all particles must retain some minimum
distance from each other in the initial conditions. That is
$$\|x_i - x_j\| > \delta$$ where $\delta$ is some small number. This
restriction is due to the fact that the model as point particles doesn't
make sense at very small distances. For an accurate model in this
domain, we have to use quantum mechanics. Next, all particles must have
velocity that isn't too large. That is, $$\|v_i \| \ll c$$ The reason
for this is that this model isn't set up to handle relativistic effects.
We also have to place some restrictions on our charges as well. All
charges must be not too large. That is, $$|q_i| < Q$$ where $Q$ is some
charge \"ceiling.\" And as before, we will require that the particles we
consider are neither too light nor too large. $$\begin\{aligned\}
    M_\{\textrm\{min\}\} \ll m_i \ll M_\{\textrm\{max\}\}
\end\{aligned\}$$

Let's assume that we can measure the force on a tiny \"test charge\" $q$
at each point $\vec\{x\}$ up to Gaussian noise (with variance $\epsilon$)
to get our observation model.
$$\vec\{F\}_\{\textrm\{measured\}\} = \frac\{1\}\{4 \pi \epsilon_0\} \sum_\{j \neq i\} \frac\{qq_j\}\{\|\vec\{x\} - \vec\{x_j\}\|^2\} \frac\{\vec\{x\} - \vec\{x_j\}\}\{\|\vec\{x\} - \vec\{x_j\}\|\} + \textrm\{Normal\}(0, \epsilon)$$

::: center
       States                                                                        $\mathcal\{S\} = \mathbb\{R\}^\{6n\}$
  ----------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------
     Symmetries                                                                             $\mathcal\{G\} = \{\
                             E = \sum_\{i=1\}^N \left (\frac\{1\}\{2\}m_i \|\vec\{v_i\}\|^2 + \frac\{1\}\{4\pi \epsilon_0\}\sum_\{i \neq j\} \frac\{q_i q_j\}\{\|\vec\{x_i\} - \vec\{x_j\} \|\} \} \right )
                                                                                                     \}$
      Operators                         $\mathcal\{O\} = \{\vec\{U\}(t) = \vec\{x\}(0) + \int_0^t \vec\{v\}(0) + \left (\int_0^v \frac\{\vec\{F_i\}\}\{m\}(u) du \right ) dv \}$
     Parameters                           $\mathcal\{W\} = \{(m_i, q_i, \vec\{x_i\}(0), \vec\{v_i\}(0))\} = (\mathbb\{R\}^+, \mathbb\{R\}, \mathbb\{R\}^3, \mathbb\{R\}^3)^n$.
     Constraints                                                       $\mathcal\{C\} = \{\vec\{v\} \ll c, \|x_i - x_j\| \gg \delta \}$
   Hyperparameters                                   $\mathcal\{HP\} = \{M_\{\textrm\{min\}\} \ll m \ll M_\{\textrm\{max\}\}, \delta, c, q_i \ll Q, \epsilon\}$
     Observables                                         $\mathcal\{B\} = \{\vec\{F\}_\{\textrm\{measured\}\} = \vec\{F\}(x) + \mathcal\{N\}(0, \epsilon) \}$

[]\{#phs:theory:moving:particle label="phs:theory:moving:particle"\}\
*Summary of physical theory for a collection of point charges.*
:::
