# Long Range Atomic Contacts \{#chap:long_range_atomic\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:graphconvs\]](#chap:graphconvs)\{reference-type="ref+label"
reference="chap:graphconvs"\},
[\[chap:equivariant_networks\]](#chap:equivariant_networks)\{reference-type="ref+label"
reference="chap:equivariant_networks"\},
[\[chap:molecular_dynamics\]](#chap:molecular_dynamics)\{reference-type="ref+label"
reference="chap:molecular_dynamics"\},
[\[chap:dft\]](#chap:dft)\{reference-type="ref+label"
reference="chap:dft"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In previous chapters, we have learned about some mathematical
representations of molecular structure that respects the relevant
invariances of the underlying system. However, we made a key
approximation by introducing cutoffs into the system that assume that
all interactions happen within a certain distance. This approximation
limits the accuracy of our models since longer range interactions do
play a world in real molecular systems.

In this chapter, we introduce long-range features that incorporate a
form of Coulomb-interactions into computed descriptors
[@grisafi2018symmetry], [@grisafi2018transferable],
[@grisafi2019incorporating]. This representation represents a molecules
as an $O(3)$ equivariant feature vector. These longer range interactions
will allow us to represent more accurately long-range physical effects
such as polarization and dispersion interactions. Representing long
range contacts is challenging for atomic systems in force fields.

## Representing Atomic Densities

We can represent a molecule in a density representation by the equation
(using physics style notation).

$$\begin\{aligned\}
    \langle r | \mathcal\{A\} \rangle &= \sum_i g(r-r_i)|\alpha_i \rangle
\end\{aligned\}$$

Here $|\alpha_i \rangle$ is a feature vector that describes the local
atomic environment around atom $i$, and $g$ is some interaction term
which describes the effect of atom $i$ on position $r$ (typically some
Gaussian). In general, feature vectors $|\alpha_i \rangle$ are computed
using local neighbors within some distance cutoff. To expand this cutoff
to allow for long range interactions, we need to allow for a nonlocal
interaction term. We perform the update $$\begin\{aligned\}
g(r-r_i) \mapsto \int dr' \frac\{g(r'-r_i)\}\{|r' - r|^p\}
\end\{aligned\}$$ This update replaces the local feature vector with an
integral over all space. This integral, especially for low values of $p$
enables long range communication between atoms. After this
transformation, the atom density potential representation is given by
$$\begin\{aligned\}
    \langle r | \mathcal\{V\}^p \rangle &= \sum_i |\alpha_i \rangle \int dr' \frac\{g(r'-r_i)\}\{|r'-r|^p
    \}
\end\{aligned\}$$

This basic representation is not invariant to transformation groups. To
provide invariance over group $G$, we perform the integral

$$\begin\{aligned\}
\int dG \langle r | G | \mathcal\{V\}^p \rangle
\end\{aligned\}$$

By symmetrizing over the rotation, translation and inversion groups, we
can obtain a representation equivariant to $E(3)$.

## Symmetry adapted tensor products

Basis set methods represent the electronic density $\rho(r)$ as a sum of
atom-centered basis functions

$$\begin\{aligned\}
    \rho(r) &= \sum_i \rho_i(r) \\
    &= \sum_\{i, k\} c^i_k \phi^i_k(r) \\
    &= \sum_\{i, k\} c^i_k \phi_k(r-r_k)
\end\{aligned\}$$ Here the $\phi_k$ are a basis set of atom-centered
density functions. Each basis function is factorized as

$$\begin\{aligned\}
    \phi_k(r) &= \phi_\{nlm\} \\
    &= R_n(|r|)Y^l_m(\hat\{r\}) 
\end\{aligned\}$$ where the $R_n$ are radial basis functions and $Y^l_m$
are spherical harmonics.

## Training A LODE Model

As with ACE, the LODE representation computes plain features that are
non-tunable, so the method can be fitted directly with linear
regression.
