# Variational Principle \{#chap:quantum_variational\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Suppose that $H$ is a Hamiltonian which is too complex to allow for
direct solution of Schrodinger's equation. The variational principle
provides a method to construct structured approximations to the solution
of $H$ by leveraging a lower bound inequality on the energy of the
system.

## The Variational Principle

The variational principle states that for any normalized wave function
$\psi$, we have that

$$\begin\{aligned\}
E \leq \langle \psi | H | \psi \rangle 
\end\{aligned\}$$

Here $E$ is the ground state energy for the Hamiltonian. To see this,
note that the eigenfunction of $H$ form a complete basis for the base
Hilbert space $\mathcal\{H\}$.

Let us denote these wave functions as $\psi_i$ with associated energies
$E_i$. Then we can expand any potential wave function as
$$\begin\{aligned\}
    \psi &= \sum_i c_i \psi_i
\end\{aligned\}$$ We can then compute $$\begin\{aligned\}
    \langle \psi | H | \psi \rangle &= \Big \langle \sum_i c_i \psi_i \Big | H \Big | \sum_j c_j \psi_j \Big  \rangle \\
    &= \Big \langle \sum_i c_i \psi_i \Big | \sum_j c_j E_j \psi_j \Big \rangle \\
    &= \sum_\{ij\} c^*_i c_j E_j \langle \psi_i | \psi_j \rangle \\
    &= \sum_\{i\} |c_i|^2 E_i \\
    &\geq E_\{\textrm\{ground\}\}
\end\{aligned\}$$

By choosing different guesses for $\psi$ and computing
$\langle \psi | H | \psi \rangle$ we can upper bound the ground state
quantum energy of the system. In the case that our guess is not
normalized, we replace the inequality above with the normalized version
$$\begin\{aligned\}
    E_\{\textrm\{ground\}\} \leq \frac\{\langle \psi | H | \psi \rangle \}\{\langle \psi | \psi \rangle\}
\end\{aligned\}$$

## Variational Monte Carlo

The basic variational approach can be applied analytically for simple
systems, but larger quantum mechanical systems require the use of
numerical techniques. Suppose that have a parameterized wave function

$$\begin\{aligned\}
    \psi(\theta)
\end\{aligned\}$$

where $\theta$ is some set of parameters. We write $$\begin\{aligned\}
    E_\theta &= \frac\{\langle \psi(\theta) | H | \psi(\theta) \rangle \}\{\langle \psi(\theta) | \psi(\theta) \rangle\}
\end\{aligned\}$$ Note that the denominator can be written as
$$\begin\{aligned\}
   \langle \psi(\theta) | \psi(\theta) \rangle &= \int \psi^*(\theta) \psi(\theta) dx \\
   &= \int \|\psi(\theta)\|^2 dx
\end\{aligned\}$$ The numerator can be written as

$$\begin\{aligned\}
    \langle \psi(\theta) | H | \psi(\theta) \rangle &= \int \psi^*(\theta) H \psi(\theta) dx \\
    &= \int \|\psi(\theta)\|^2 \frac\{H \psi(\theta)\}\{\psi(\theta)\} dx
\end\{aligned\}$$ Combining, we can write $$\begin\{aligned\}
    E_\{\theta\} &= \frac\{\int \|\psi(\theta)\|^2 \frac\{H\psi(\theta)\}\{\psi(\theta)\} dx\}\{\int \|\psi(\theta)\|^2 dx\} \\
    &= \int \frac\{\|\psi(\theta)\|^2\}\{\int \|\psi(\theta)\|^2 dx\} \frac\{H\psi(\theta)\}\{\psi(\theta)\} dx
\end\{aligned\}$$ We define $$\begin\{aligned\}
    q(\theta) &= \frac\{\|\psi(\theta)\|^2\}\{\int \|\psi(\theta)\|^2 dx\}
\end\{aligned\}$$ and note that $q$ is a probability distribution. So we
can write $$\begin\{aligned\}
    E_\theta &= \int q(\theta) \frac\{H \psi(\theta)\}\{\psi(\theta)\} \\ 
    &= E_q \left [\frac\{H \psi(\theta)\}\{\psi(\theta)\} \right ]
\end\{aligned\}$$

By sampling from $q$, this expectation can be computed numerically
$$\begin\{aligned\}
    E_\theta \approx \frac\{1\}\{N\} \sum_i \frac\{H\psi(\theta)(x_i)\}\{\psi(\theta)(x_i)\}, \quad x_i \sim q(\theta)
\end\{aligned\}$$

By varying choice of $\theta$, we can improve the lower bound
$E_\theta$. The choice of $\psi(\theta)$ is critical for these
approximations. A simple choice is to do a direct factorization. For
example, for a system with $N$ electrons,

$$\begin\{aligned\}
    \psi(X) &= \psi(x_1)\psi(x_2)\dotsc \psi(x_n)
\end\{aligned\}$$ A more sophisticated decomposition makes use of what is
called a Jastrow factor $$\begin\{aligned\}
    \psi(X) &= \exp \left ( \sum_\{ij\} u(r_\{ij\}) \right )
\end\{aligned\}$$


# A Brief Introduction to Superconductor Theory \{#chap:superconductors\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter we provide a brief introduction to the quantum mechanics
of superconductors. A superconductor is a special system which is both a
perfect conductor and which expels external magnetic fields.

## BCS Theory

The BCS theory provides a basic model of superconductivity by modeling
the interactions between electrons and phonons in the system. In
particular, phonons mediate an attractive electron-electron
interactions. These interacting pairs are called Cooper pairs. This
system can be modeled by an attractive potential $V(r_1 - r_2)$ where
$r_1$ and $r_2$ are the positions of two electrons.

Superconductivity occurs when this attractive force dominates the
repulsive force from the Coulomb potential. The BCS theory also
successfully predicts the second order phase transition at the critical
temperature $T_c$.

## Superconducting Density Functional Theory

A successful computational strategy to model superconductivity has been
to use density functional theory with a custom exchange-correlation
functional to model superconducting systems.


# Scattering Theory \{#chap:quantum_harmonic\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:harmonic\]](#chap:harmonic)\{reference-type="ref+label"
reference="chap:harmonic"\},
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\},
[\[chap:position_and_momentum\]](#chap:position_and_momentum)\{reference-type="ref+label"
reference="chap:position_and_momentum"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

A scattering process studies the collision of particles. Mathematically
for a scattering process, we start from an input state of particles and
end with a final state. The scattering process can be modeled either
classically or quantum mechanically.

## Classical Scattering

Broadly, classical scattering can be broken into elastic and ineleastic
scattering. Elastic scattering conserves energy and treats particles as
point objects that don't change in the collision. Inelastic collisions
allow for the possibility of deformation and the loss of energy during
the collision process.

## Quantum Mechanical Scattering

The transformation process can be modeled as a time dependent
perturbation since the shifting event can often be tightly focused in
time (a particle collision for example)

Let us start by writing the Hamiltonian to model the scattering process
as as $$\begin\{aligned\}
    H &= H_0 + V_I(r) \\
    H_0 &= \frac\{p^2\}\{2m\}
\end\{aligned\}$$ The eigenvalues of the kinetic energy component $H_0$
are $$\begin\{aligned\}
E_k &= \frac\{\hbar^2k^2\}\{2m\}
\end\{aligned\}$$

Let $\alpha(t)$ denote the state at time $t$. We have the transition
equation

$$\begin\{aligned\}
    |\alpha(t)\rangle_I &= U_I(t)|\alpha(t_0) \rangle_I\\
\end\{aligned\}$$ Here $U_I$ satisfies the equation $$\begin\{aligned\}
    i\hbar\frac\{\partial\}\{\partial t\} U_I(t, t_0) &= V_I(t) U_I(t, t_0)
\end\{aligned\}$$ where $$\begin\{aligned\}
    U_I(t_0) &= I \\
    V_I(t) &= \exp(iH_0t/\hbar)V\exp(-iH_0t/\hbar)
\end\{aligned\}$$

This equation has solution $$\begin\{aligned\}
U_I(t) &= 1 - \frac\{i\}\{\hbar\}\int_\{t_0\}^T V_I(t')U_I(t', t_0)dt'
\end\{aligned\}$$ Note that this equation is integrating operators. We can
then derive the following general solution for the transmission
probability from basis state $i$ to basis state $n$

$$\begin\{aligned\}
    \langle n | U_I(t)| i \rangle = \delta_\{ni\} - \frac\{i\}\{\hbar\}\sum_m \langle n|V|m \rangle \int_\{t_0\}^t e^\{i\omega_\{nm\}t'\} \langle m | U_I(t')|i \rangle dt'
\end\{aligned\}$$

For specific scattering potentials, we can then derive specific
scattering amplitudes. Such scattering amplitudes arise often in high
energy physics applications.


# Feynman-Kac Formula \{#chap:perturbation_theory\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The Feynman-Kac formula provides a powerful bridge between solutions to
certain classes of PDEs and solutions to stochastic differential
equations. In practice, the formula can provide a powerful formula to
resolve certain classes of intractable PDEs.

## Statement

Suppose that we have a parabolic PDE given by

$$\begin\{aligned\}
\frac\{\partial u\}\{\partial t\}(x, t) + \mu(x, t)\frac\{\partial u\}\{\partial x\}(x, t) + \frac\{1\}\{2\}\sigma^2(x, t)\frac\{\partial^2 u\}\{\partial x^2\}(x, t) - V(x, t)u(x, t) + f(x, t) &= 0
\end\{aligned\}$$ where $\mu, \sigma, V, f$ are known functions. Here we
also impose a boundary condition that $$\begin\{aligned\}
u(x, T) &= \psi(x)
\end\{aligned\}$$ where $\psi$ is another known function. The Feynman-Kac
formula states that the solution to this PDE is given by the conditional
expectiation

$$\begin\{aligned\}
u(x, t) &= E\left [ \int_t^T e^\{-\int_t^r V(X_\tau, \tau) d \tau \} f(X_\tau, r) dr + e^\{- \int_t^T V(X_\tau, \tau) d \tau \psi(X_T)\}  \right ]
\end\{aligned\}$$ Here, we have that $X_\tau$ is an Itô process given by
the equation $$\begin\{aligned\}
d X_t \mu(X, T) dt + \sigma(X, t) dW_t
\end\{aligned\}$$ where $W$ is Wiener noise.

## Derivation

Let us start by considering one particular instantiation of this formula
and performing a derivation. Consider $K$ to be the poropagator of
Schrodinger's equation. Note that Schrodinger's equation is a parabolic
PDE, so we can use the Feynman-Kac formula. We start by using the
Trotter formula $$\begin\{aligned\}
    e^\{A+B\} &= \lim_\{n\to\infty\} (e^\{A/n\}e^\{B/n\})^n
\end\{aligned\}$$ Here $A$ and $B$ are matrices. The Trotter product
formula can be extended to the case $A$ and $B$ are self-adjoint
operators and $A+B$ is self-adjoint on the intersection of the domains
of $A$ and $B$.

$$\begin\{aligned\}
    e^\{-it(A+B)\} &= s - \lim_\{n\to\infty\} \left (e^\{-itA/n\}e^\{-itB/n\}\right )^n
\end\{aligned\}$$ Consider the unitary time evolution kernel
$$\begin\{aligned\}
    K(t, q, q') &= \langle q | e^\{-itH\}|q'\rangle 
\end\{aligned\}$$ Suppose that the Hamiltonian has form $H_0 + V$. Then we
split up the evolution into $n$ steps by using the Trotter formula.
$$\begin\{aligned\}
    K(t, q, q') &= \lim_\{n\to\infty\} \langle q | \left (e^\{-itH_0\}e^\{-itV\} \right )^n|q'\rangle 
\end\{aligned\}$$ We insert the decomposition of identity given below $n$
times between the factors $$\begin\{aligned\}
    I &= \int dw_j |w_j\rangle \langle w_j |
\end\{aligned\}$$ And we obtain $$\begin\{aligned\}
    K(t,q,q') &= \lim_\{n\to\infty\} \int dw_1 \dotsc dw_n \prod_\{j=0\}^\{n-1\} \langle w_\{n+1\} | e^\{-itH_0/n\}e^\{-itV/n\}|w_j\rangle
\end\{aligned\}$$ We note that the potential is diagonal in the coordinate
representation since it directly multiplies by a constant value at each
point in position space. Thus we can write $$\begin\{aligned\}
    \langle w_\{n+1\} | e^\{-itH_0/n\}e^\{-itV/n\}|w_j\rangle &= \langle w_\{n+1\} | e^\{-itH_0/n\}|w_j\rangle e^\{-itV(w_j)/n\}
\end\{aligned\}$$ Note that the free propagator is given by
$$\begin\{aligned\}
    K_0(t, q, q') &= \langle q' | e^\{-itH\} q \rangle \\
    &= \left(\sqrt\{\frac\{m\}\{2\pi i \hbar t\}\}\right)^d e^\{im(q-q')^2/2\hbar t\} \\
    &= A_t^d e^\{im(q-q')^2/2\hbar t\}
\end\{aligned\}$$ where $$\begin\{aligned\}
    A_t &= \sqrt\{\frac\{m\}\{2\pi i \hbar t\}\}
\end\{aligned\}$$ Plugging this all together we obtain $$\begin\{aligned\}
    K(t, q, q') &= \lim_\{n\to\infty\} A_\{\epsilon\}^n \int dw_1 \dotsc dw_\{n-1\}e^\{iS^\{(n)\}(w)/\hbar\} \\
    S^\{(n)\}(w) &= \frac\{m\}\{2\}\sum_\{j=0\}^\{n-1\}\epsilon \left ( \frac\{w_\{j+1\} - w_j\}\{\epsilon\}\right) - \sum_\{j=0\}^\{n-1\} \epsilon V(w_j)
\end\{aligned\}$$ This last quantity is a Riemann sum approximation to the
action of a particle moving along the specified path $$\begin\{aligned\}
    S^\{(n)\}(w) &\to \int_0^t ds (\frac\{m\}\{2\}\dot\{w\}^2 - V(w)) \\
    &= S(w)
\end\{aligned\}$$ This formula is often written thematically as
$$\begin\{aligned\}
K(t, q, q') &= \int_\{w(0)=q\}^\{w(t) =q'\} \mathcal\{D\}w e^\{iS[w]/\hbar\}
\end\{aligned\}$$ where the integral is taken over all possible paths.


# Spin and Fermionic Path Integrals \{#chap:spin_fermionic\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:path_integrals\]](#chap:path_integrals)\{reference-type="ref+label"
reference="chap:path_integrals"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

[TODO: Cite Shankar]\{style="color: red"\}

Suppose we have a spin system with $S$ degrees of freedom. We can model
this spin with a $2S+1$ dimensional Hilbert space $\mathcal\{H\}$. We can
then resolve the identity as $$\begin\{aligned\}
    I = \sum_\{-S\}^\{S\}|S_Z\rangle \langle S_Z |
\end\{aligned\}$$

[TODO: I'm having trouble following the discussion in Shankar. I think
the idea is to use a non-standard resolution of identity. We eventually
reach the propagator definition here]\{style="color: red"\}

$$\begin\{aligned\}
\langle \Omega_f | U(t) | \Omega_i \rangle &= \int [\mathcal\{D\}\Omega] \exp \Bigg[i\int_\{t_1\}^\{t_2\} [S\cos \theta \dot\{\phi\} - \mathcal\{H\}(\Omega)] dt\Bigg]
\end\{aligned\}$$

(TODO: Shankar notes there are apparently major convergence issues here)

## Fermionic Oscillator

## Fermionic Path Integrals


# Quantum Harmonic Oscillators \{#chap:quantum_harmonic\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:harmonic\]](#chap:harmonic)\{reference-type="ref+label"
reference="chap:harmonic"\},
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\},
[\[chap:position_and_momentum\]](#chap:position_and_momentum)\{reference-type="ref+label"
reference="chap:position_and_momentum"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The quantum harmonic oscillator is a quantum mechanical version of the
classical oscillator we saw in
[\[chap:harmonic\]](#chap:harmonic)\{reference-type="ref+label"
reference="chap:harmonic"\}. Quantum harmonic oscillators also arise as a
foundational building block for systems in condensed matter and quantum
field theory.

## The Basic Oscillator

The energy for a classical harmonic spring system was given by
$$E = \frac\{p^2\}\{2m\} + \frac\{1\}\{2\}kx^2$$ Quantizing this energy, we
arrive at the Hamiltonian for a quantum mechanical oscillator.
$$\hat\{H\} = \frac\{\hat\{p\}^2\}\{2m\} + \frac\{1\}\{2\}k\hat\{x\}^2$$ How should we
think about this equation? Proceeding with intuition based on the
classical energy, this operator states that as the energy and momentum
grows larger, the system has higher and higher energy.

We start by defining some fundamental types for this system. The state
space $\mathcal\{S\}$ should be a suitable Hilbert space $\mathcal\{H\}$ of
wave functions. For this example, we will take $\mathcal\{H\}$ to be the
space of square-integrable functions over $\mathbb\{R\}^3$,
$L^2(\mathbb\{R\}^3)$

The time evolution of the system is given by Schrodinger's equation. In
our case, the equation becomes $$\begin\{aligned\}
        i \hbar \frac\{d\}\{dt\} | \psi(t) \rangle = \left (\frac\{\hat\{p\}^2\}\{2m\} + \frac\{1\}\{2\} k \hat\{x\}^2 \right ) |\psi(t) \rangle
\end\{aligned\}$$

The parameters are $$\begin\{aligned\}
\mathcal\{W\} = \{m, k, |\psi(0)\rangle \}
\end\{aligned\}$$ where $k$ is the harmonic constant and $|\psi(0)\rangle$
is the initial condition of the wave function.

Recall that the velocity operator is defined by
$$\hat\{v\} = -\frac\{i\hbar\}\{m\} \frac\{\partial\}\{\partial x\}$$ We constrain
$$\|\hat\{v\}\|_2 \ll c$$ where $\| \hat\{v\}\|_2$ is the spectral norm of
$\hat\{v\}$. Hyperparameters $\mathcal\{HP\}$ are $c$, the speed of light,
and noise parameter $\epsilon$.

In the classical quantum mechanical sense, any self-adjoint operator on
$\mathcal\{H\}$ can be an observable. We choose the position operation
$\hat\{x\}$ to be the observable we can measure. Recall that taking a
measurement of $\hat\{x\}$ projects onto the eigenstates of $\hat\{x\}$
(which are just the points in $\mathbb\{R\}^3$). We will assume that we
have a noise process $\mathrm\{Normal\}(0, \epsilon)$ on this measurement

[]\{#phs:theory:moving:particle label="phs:theory:moving:particle"\}

## The Vibrational Modes of a Diatomic Molecule

The vibrational modes of a diatomic molecule can be determined by
considering a single particle in a harmonic potential. Consider a
diatomic molecule with atomic masses $m_1$ and $m_2$. The covalent bond
between the two atoms can be modeled as a harmonic spring with spring
constant $k$. If we define $x$ to be the distance of separation between
the two atoms, we have the governing equation for the wave-packet as

$$\begin\{aligned\}
\hat\{H\} \psi &= E \psi \\
-\frac\{h^2\}\{8 \pi^2 \mu\} \frac\{d^2\psi\}\{dx^2\} + \frac\{1\}\{2\}kx^2\psi &= E \psi
\end\{aligned\}$$

Where $$\begin\{aligned\}
\mu &= \frac\{m_1m_2\}\{m_1+m_2\}
\end\{aligned\}$$ Upon solving this equation, we have an infinite number
of solutions with discreet energy levels. In general, the $nth$
wave-packet can be described by:

$$\begin\{aligned\}
\label\{exmp4b\}
\psi_n = \left(\frac\{1\}\{n!2^na\sqrt\{\pi\}\}\right)^\{1/2\} H_n\left(\frac\{x\}\{a\}\right) \exp\left(-\frac\{x^2\}\{2a^2\}\right)
\end\{aligned\}$$

Where $a^4=\frac\{h^2\}\{4\pi^2\mu k\}$ and the function $H_n(u)$ represents
the Hermite polynomials as $$\begin\{aligned\}
H_0(u) &=1\\
H_1(u) &=2u\\
H_2(u) &= 4u^2 - 2 \\
H_3(u) &= 8u^3-12u
\end\{aligned\}$$ for the first four states. Following this procedure, the
energy of the $nth$ state can be described as:

::: marginfigure
![image](figures/Physics/quantum_mechanics/harmonic_oscillator/harmonicoscillator.png)\{width="\\linewidth"\}
:::

$$\begin\{aligned\}
\label\{exmp4c\}
E_n = \left( n+\frac\{1\}\{2\}\right)\frac\{h\nu\}\{2\pi\}
\end\{aligned\}$$

Where $\nu=\sqrt\{\frac\{k\}\{\mu\}\}$ and $n=0,1,2,3,4.....$ are the quantum
mechanical modes of motion. As in the case of classical mechanics, the
characteristic frequency $\nu$ plays an important role in determining
the solutions using the quantum mechanical solutions, as shown in
Fig. [\[fig:harmonicoscillator\]](#fig:harmonicoscillator)\{reference-type="ref"
reference="fig:harmonicoscillator"\}.

## Particle in a box

We can use the quantum harmonic oscillator to help us solve more complex
models. Consider now a particle with 1-D motion along the $x$ axis in a
box of length L from $x=0$ to $x=L$. The external potential is assigned
as $$\begin\{aligned\}
V(x,t) = \begin\{cases\} 
0 & \textrm\{ for $0 < x < L$\} \\
\rightarrow \infty & \textrm\{ for $x \geq L$ and $x \leq 0$\} 
\end\{cases\}
\end\{aligned\}$$ We illustrate $V(x)$ in
Fig. [\[fig:partinbox\]](#fig:partinbox)\{reference-type="ref"
reference="fig:partinbox"\}.

::: marginfigure
![image](figures/Physics/quantum_mechanics/schrodingers_equation/particle_in_box0.png)
:::

The governing equation for the particle inside the box is:

$$\begin\{aligned\}
\hat\{H\} \psi &= E \psi \\
-\frac\{h^2\}\{8 \pi^2 m\} \frac\{d^2\psi\}\{dx^2\} &= E \psi
\end\{aligned\}$$

This equation has the boundary conditions $\psi=0$ at $x=0$ and at
$x=L$. The equation can be written in the same form as that of a
harmonic oscillator as:

$$\begin\{aligned\}
\label\{exmp3b\}
\frac\{d^2\psi\}\{dx^2\} + G^2\psi=0
\end\{aligned\}$$

Where $G^2=\frac\{8mE \pi^2\}\{h^2\}$. The solution for this system is given
as:

$$\begin\{aligned\}
\label\{exmp3c\}
\psi = C_1\sin(Gx)+ C_2\cos(Gx)
\end\{aligned\}$$

To satisfy the boundary conditions, we must have $C_2=0$. The remaining
solution has infinite possibilities because $\sin(n\pi)=0$ for
$n=1,2,3,4.......$ The condition for the solution thus results in:

$$\begin\{aligned\}
\label\{exmp3d\}
G_n = \pi\sqrt\{\frac\{8m E_n\}\{h^2\}\} = \frac\{n\pi\}\{L\}
\end\{aligned\}$$

This implies:

$$\begin\{aligned\}
\label\{exmp3e\}
E_n = \frac\{h^2\}\{8mL^2\}n^2
\end\{aligned\}$$

Using the condition that $|\psi|^2$ has to be normalized, we have
$$\begin\{aligned\}
C_1 &= \sqrt\{\frac\{2\}\{L\}\}
\end\{aligned\}$$ Hence, the solution for the wave-packet for the $n^\{th\}$
quantum state of the particle is:

::: marginfigure
![image](figures/Physics/quantum_mechanics/harmonic_oscillator/schrodingereqnsoln0.png)\{width="\\linewidth"\}
:::

$$\label\{exmp3f\}
\psi_n(x) = \sqrt\{\frac\{2\}\{L\}\} \sin \left (\frac\{n \pi x\}\{L\}\right )$$

One can easily extend this to 3-dimensions, which instead of $n$ would
result in $n_x,n_y,n_z$. However, what is more important here is to
understand the quantization of the energy levels in terms of n. For
varying $n$, we get different solutions of the Schrödinger equation in
1-dimension, as shown in
Fig. [\[fig:schrodingereqnsoln\]](#fig:schrodingereqnsoln)\{reference-type="ref"
reference="fig:schrodingereqnsoln"\}.


# Quantum Mechanics \{#chap:quantum_mechanics\}

------------------------------------------------------------------------

\
**Prerequisites:** [\[chap:pde\]](#chap:pde)\{reference-type="ref+label"
reference="chap:pde"\},
[\[chap:simple_physics\]](#chap:simple_physics)\{reference-type="ref+label"
reference="chap:simple_physics"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Quantum mechanics deals with the physics of the very small. Objects like
electrons and photons can behave in ways that are alien to normal
physical intuition. Quantum mechanical systems are described by wave
functions instead of positions, a change which will dramatically alter
the mathematics needed to model these systems.

Although classical mechanics is successful when applied for macroscopic
objects, several experimental observations demonstrate the inadequacy of
classical mechanics in treating microscopic phenomena. For example:

1.  The Rayleigh-Jeans formula for spectral intensity of black body
    radiation, which was based on laws of mechanics, electromagnetic
    theory and statistical thermodynamics failed for short wavelengths
    in what was called as the ultraviolet catastrophe. Max Planck later
    postulated that the oscillating atoms of a black body radiate energy
    only in discrete, i.e. quantized amounts which was found to be in
    agreement with experimental observations
    (Fig. [\[fig:planckslaw\]](#fig:planckslaw)\{reference-type="ref"
    reference="fig:planckslaw"\}).

2.  The interference patterns that arise from light impinging on a
    double-slit experiment, originally done by Young, brought into
    forefront the fact that light and matter can display characteristics
    of both classically defined waves and particles. Young showed by
    means of a diffraction experiment that light behaved as waves. He
    also proposed that different colors were caused by different
    wavelengths of light
    (Fig. [\[fig:youngsslit\]](#fig:youngsslit)\{reference-type="ref"
    reference="fig:youngsslit"\}).

    ::: marginfigure
    ![image](figures/Physics/quantum_mechanics/intro_qm/diffraction pattern.png)\{width="\\linewidth"\}
    :::

3.  The photoelectric effect, explained by Albert Einstein, which is the
    phenomenon of emission of electrons from a metallic surface that is
    subjected to electromagnetic radiation. In case light was only a
    wave, the energy contained in one of those waves would depend only
    on its amplitude, i.e. on the intensity of the light. Other factors,
    like the frequency, should make no difference. However, electron
    emission was found to occur at a threshold frequency (not intensity)
    and the maximum kinetic energy of the emitted electrons was found to
    depend on the frequency of the incident light
    (Fig. [\[fig:photoelectric\]](#fig:photoelectric)\{reference-type="ref"
    reference="fig:photoelectric"\}).

    ::: marginfigure
    ![image](figures/Physics/quantum_mechanics/intro_qm/photoelectric.png)\{width="\\linewidth"\}
    :::

In the following few chapters, we will establish the mathematical
foundations of the theory of quantum mechanics and explain how the shift
from classical to quantum mechanics can help resolve some of these
fundamental questions.

## Mathematical Theory

One of the biggest changes between quantum and classical mechanics is
that we will deal more often with function types since the quantum
mechanical description of a system is given by a *wave function*.

Intuitively, in quantum mechanics, it is no longer reasonable to speak
of hard quantities like \"position\" or \"velocity.\" Using rough
language, we can say that quantum mechanical objects are more accurately
imagined as \"smeared out\". For an electron, rather than a point
particle, we can imagine it as a probability distribution spread out
over space. The takeaway for now is that position types like
$\mathbb\{R\}^3$ are no longer appropriate for describing electrons.
Instead, we want to consider function types like
$\mathbb\{R\}^3 \to \mathbb\{C\}$ (for technical reasons, we want to use the
complex numbers rather than the real numbers).

Giving you a sneak peek of more technical considerations, it turns out
the space of all functions from $\mathbb\{R\}^3 \to \mathbb\{C\}$ is too big
for our purposes. We will more often work in the space of square
integrable functions $L^2(\mathbb\{R\}^3, \mathbb\{C\})$. Recall that a
function $f$ is square-integrable if

$$\begin\{aligned\}
    \int_\{\mathbb\{R\}^3\} |f(x)|^2 dx < \infty
\end\{aligned\}$$

Recall that the space $L^2(\mathbb\{R\}^3, \mathbb\{C\})$ is a Hilbert
space. A wave function $\psi$ is then an element of
$L^2(\mathbb\{R\}^3, \mathbb\{C\})$. To a rough approximation the core
mathematical transformation to go from classical mechanics is that we
make the replacement

$$\begin\{aligned\}
    \mathbb\{R\}^3 \Rightarrow L^2(\mathbb\{R\}^3, \mathbb\{C\})
\end\{aligned\}$$

That is, position vectors are replaced with wave functions. This process
is typically called *quantization*. Much of the mathematical complexity
of quantum mechanics results from the fact that
$L^2(\mathbb\{R\}^3, \mathbb\{C\})$ is a more complicated space that
$\mathbb\{R\}^3$. To make things even more complicated, when we take
actual experimental measurements in the real world, we will end up with
numbers in $\mathbb\{R\}^3$. We need a theory of measurements that can
\"collapse\" our wave functions into more concrete objects.

As an important technical note, we also observe that other spaces
besides $L^2(\mathbb\{R\}^3, \mathbb\{C\})$ can be used to model quantum
systems. We will encounter some other such spaces in our study of spin
and quantum field theories later in the book. The more general point is
that the choice of type to associate with a physical system is a
modeling choice. If you are ever in doubt about the right set of types
to model a physical system, step back and think about which fits the
underlying physics better in the given circumstances.

In this and the following chapters we will introduce you to quantum
mechanics and discuss how differentiable programs can help build
understanding. As always, it is surprisingly useful to keep an eye out
on the types of objects we work with. While physicists classically mix
and match different mathematical objects when describing quantum
mechanical systems, we find that looking at the types provides an
alternative to these traditional methods that can bring its own
insights.

## More About Wave Functions

Let's consider a simple test system with one particle and no spin. Then
let $\psi: \mathbb\{R\}^3 \times \mathbb\{R\} \to \mathbb\{C\}$ be a complex
valued function. For a position $\vec\{x\}$ in space and time $t$,
$\psi(x, t)$ is a complex valued amplitude. We define an associated
function $\rho: \mathbb\{R\}^3 \times \mathbb\{R\} \to \mathbb\{C\}$ as

$$\begin\{aligned\}
    \rho(\vec\{x\}, t) = |\psi(\vec\{x\}, t)|^2
\end\{aligned\}$$

We want to interpret $\rho$ as a probability density function.
Informally we can think of $\rho$ as representing the probability of our
particle being at position $\vec\{x\}$ at time $t$. Note that for $\rho$
to be a probability density function, we need the following
normalization condition to be satisfied.

$$\begin\{aligned\}
\
\int_\{-\infty\}^\{\infty\} |\psi(\vec\{x\}, t)|^2 dx = \int_\{-\infty\}^\{\infty\} \rho(\vec\{x\}, t) dx = 1
\end\{aligned\}$$

That is, at a given time $t$, the probability density $\rho$ must
integrate to probability 1. The condition that $\rho$ forms a
probability distribution automatically guarantees that
$\psi \in L^2(\mathbb\{R\}^3 \times \mathbb\{R\}, \mathbb\{C\})$ (since
$\int_\{\mathbb\{R\}^3 \times \mathbb\{R\}\} |f(x)|^2 dx < \infty$). Another
interesting thing to note though is that by our definition an arbitrary
$g \in L^2(\mathbb\{R\}^3 \times \mathbb\{R\}, \mathbb\{C\})$ can't be a wave
function. Suppose that $g$ satisfies the following equation

$$\begin\{aligned\}
    \int_\{\mathbb\{R\}^3 \times \mathbb\{R\}\} |g(x)|^2 dx = C \neq 1.
\end\{aligned\}$$

$g$ has a bounded square integral, but its norm is not 1. In this case
$\rho_g$ (that is, $\rho_g := |g(x)|^2$) doesn't form a probability
distribution. For this reason, in mathematical introductions to quantum
mechanics its more common to work with the \"projective space\"
$$\begin\{aligned\}
    \mathcal\{P\}L^2(\mathbb\{R\}^3 \times \mathbb\{R\}, \mathbb\{C\}) := \{ f \in L^2(\mathbb\{R\}^3, \mathbb\{R\})| \|f\| = 1\}
\end\{aligned\}$$ We will find it useful to work with arbitrary elements
of $L^2(\mathbb\{R\}^3 \times \mathbb\{R\}, \mathbb\{C\})$ so we often just
identify arbitrary elements $g$ with their normalized version $g/\|g\|$.
Transforming to code,

    def $\psi$(x: $\mathbb\{R\}^3$, t: $\mathbb\{R\}$) -> $\mathbb\{C\}$:
      return C * exp(-m * $\|$x$\|^2$/2)
    assert $\psi$ : $L^2(\mathbb\{R\}^3 \times \mathbb\{R\}, \mathbb\{C\})$

    def pdf(x: $\mathbb\{R\}^3$, t: $\mathbb\{R\}$):
      return $|\psi$(x, t)$|^2$

Note the definition of $\psi$: it's just a regular function. Wave
functions sometimes gain a degree of mystique, but it's useful to see
that we can define them with a few lines of Physika like any other
function. Note also that the type signature of $\psi$ in this definition
is $\mathbb\{R\}^3 \times \mathbb\{R\} \to \mathbb\{C\}$ and not
$L^2(\mathbb\{R\}^3, \mathbb\{R\})$ by default. We use an `assert` statement
to tell Physika that $\psi$ belongs to the more refined type
$L^2(\mathbb\{R\}^3 \times \mathbb\{R\}, \mathbb\{C\})$.

The wave function $\psi$ itself is simply a Gaussian bump function. The
function `pdf` is a convenience function that gives us a way to find the
probability that a particle with wave function $\psi$ is at some
specified $x$ and $t$.

We can generalize this to a formulation for multiple particles in a
straightforward fashion. Let's suppose that we have $N$ particles at
$\vec\{x_1\}, \dotsc, \vec\{x_N\}$. Then we have
$\Phi: \mathbb\{R\}^\{3N + 1\} \to \mathbb\{C\}$ a function where

$$\Phi(\vec\{x_1\}, \dotsc, \vec\{x_N\}, t)$$

is the complex amplitude of a collection of $N$ particles at locations
$\vec\{x_1\}, \dotsc, \vec\{x_N\}$ at time $t$.

## An interlude into types

What are the types associated with quantum mechanics/ Computer
scientists may have noted that $\mathbb\{R\}$ isn't a type that can be
easily implemented in a real programming language since arbitrary
precision can't be exactly represented on a physical device with bounded
memory. That said, numerical analysts have done hard work to make sure
that modern computers have quite good representations of real numbers.
So if we have a function

    def $+$(x: $\mathbb\{R\}$, y: $\mathbb\{R\}$) -> $\mathbb\{R\}$:
      return x + y

there's a reasonable translation of this function into code. But
consider the function

    def $+$(f: $L^2(\mathbb\{R\}, \mathbb\{C\})$, g: $L^2(\mathbb\{R\}, \mathbb\{C\}))$ -> $L^2(\mathbb\{R\}, \mathbb\{R\}, \mathbb\{C\})$:
      return f + g

What does this function mean? $f$ and $g$ are infinite objects by
construction. In one sense, $L^2(\mathbb\{R\}, \mathbb\{C\})$ is \"no
bigger\" than $\mathbb\{R\}$ (that is they have the same cardinality as
sets), so it's not unreasonable that we could create reasonable
implementations for adding $L^2$ functions if we can do so for adding
real numbers. What are some ways this could make sense?

One classical method for representing functions is to reduce a function
to a suitable tuple of real numbers. For example, suppose that our
functions are polynomials

$$\begin\{aligned\}
    f(x) &= a_0 + a_1 x + \dotsc + a_n x^n \\
    g(x) &= b_0 + b_1 x + \dotsc + b_m x^m
\end\{aligned\}$$

We can then add $f$ and $g$ by adding coefficients for corresponding
terms $$\begin\{aligned\}
    (f + g)(x) &= (a_0 + b_0) + (a_1 + b_1)x + \dotsc
\end\{aligned\}$$ In this case we can implement `add_l2` by using list
types

    def $+$(f: [$\mathbb\{R\}$], g: [$\mathbb\{R\}$]) -> [$\mathbb\{R\}$]:
      return [fi + gi for (fi, gi) in zip(f, g)]

(Assume that `zip` intelligently handles lists of different lengths.)
There's also no reason you have to use polynomials as your basis here.
You could very well use Fourier coefficients or another more efficient
basis so you can represent a richer class of functions.

Of course, all this is very classical, but since we're working with deep
networks, we also have access to very powerful representations that were
not classically accessible. Consider the following definition of $f$

    def h(x: $\mathbb\{R\}$, N: $\mathbb\{N\}$) -> $\mathbb\{R\}$:
      input = x
      for i in range(N):
        wi, bi: $\mathbb\{R\}$
        input = ReLU(wi*x + bi)
      return input

Note that `h` can represent an extremely rich class of functions. Why?
`h` is a dense network that can be arbitrarily deep. In particular,
since `wi, bi` are learnable variables, in principle, arbitrary elements
of $L^2(\mathbb\{R\}, \mathbb\{R\})$ could be represented by `h` (there are
some considerably challenging questions of convergence here, but we
won't delve into those.) In this case you can define

    def add(f: $\mathbb\{R\}$ -> $\mathbb\{R\}$, g: $\mathbb\{R\}$ -> $\mathbb\{R\}$) -> ($\mathbb\{R\}$ -> $\mathbb\{R\}$):
      return $\lambda$ x: f(x) + g(x)

Arguably, this function is as close to a faithful implementation of
addition on $L^2(\mathbb\{R\}^3, \mathbb\{C\})$ as is possible on a modern
computer. A theme we will return to often is that differentiable
programming provides powerful tools for handling sophisticated function
spaces that weren't accessible to past analytical analyses. By slightly
broadening the class of functions we consider past the traditional
collections of bases, we open up a variety of doors as we shall see in
the remainder of the book.


# An Introduction to Quantization \{#chap:position_and_momentum\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter we define the quantum mechanical analogues to position
and momentum, the position and momentum operators. The general pattern
is that the mathematical formulation of quantum mechanics turns
classically vectorial quantities such as position and momentum into
operators. This process is called *quantization*. The intuition is that
the state space in quantum mechanics is more complex than that for
classical mechanics. In classical physical theories, typically a state
was a vector in $\mathbb\{R\}^n$. However, in quantum mechanics we operate
in a larger Hilbert space of wave functions. It turns out that the right
formulation for common quantities turns out to be operators that
transform wave functions.

## Position Operators

The position of a wave functions is a trickier prospect than the
position of a particle. Unlike a particle, the wave function $\psi$
spreads out over all of space. How can we pick any one position for the
wave function? One way to make sense of this is to use the fact that
$\psi$ defines a probability density $\rho$. Perhaps we could define the
position of a wave function as the expected value of probability density
$\rho$?
$$E_\rho[x] = \int_\{-\infty\}^\{\infty\} x |\psi(x)|^2 dx = \int_\{-\infty\}^\{\infty\} \psi^* x \psi dx$$

This seems to be getting a little closer to what we're looking for, but
is still a little unsatisfactory. The particle doesn't necessarily have
to be at $E_\rho[x]$. However, we can re-use a part of the definition
above to define the position operator by
$$(\hat\{x\} \psi)(x) = x \psi(x)$$ That is, we have the identity
$$E_\rho[x] = \langle \psi | \hat\{x\} | \psi \rangle$$ We can define this
operator in Physika

``` \{.python language="python"\}
def $\hat\{x\}$($\psi$: $L^2(\mathbb\{R\})$) -> $L^2(\mathbb\{R\})$:
  return $\lambda$ x: x * $\psi(x)$
```

One mathematical subtlety is the fact that $\hat\{x\}$ is not in
$\mathcal\{B\}(L^2(\mathbb\{R\}))$ so we're actually operating in a larger
type space. The reason is that the norm of the $\hat\{x\}$ operator can
get unboundedly large. To see this, note that the identity function
$f(x) = x$ is not in $L^2(\mathbb\{R\})$ since it has unbounded norm

$$\begin\{aligned\}
    \int_\{-\infty\}^\{\infty\}\|x\|^2 dx = \infty
\end\{aligned\}$$

As a result, multiplying by $x$ can take functions in $L^2$ outside
$L^2$. For this reason, we have to restrict the definition of the
position operator to a subset of $L^2(\mathbb\{R\})$ such that multiplying
by $x$ does not exist $L^2$. This space is the Schwartz space
$\mathcal\{S\}(\mathbb\{R\})$. The picture is a bit more complicated even in
that we want to operate on the dual space of the Schwartz space, which
is the space of tempered distributions. So $\hat\{x\}$ takes a tempered
distribution over $\mathbb\{R\}$ to another tempered distribution

$$\begin\{aligned\}
\hat\{x\}: \mathcal\{S\}(\mathbb\{R\}) \to \mathcal\{S\}(\mathbb\{R\})
\end\{aligned\}$$

## Momentum Operator

Momentum is also defined as an operator in the quantum mechanical
formulation. $$\begin\{aligned\}
\hat\{p\}_x = -i \hbar \frac\{\partial\}\{\partial x\}
\end\{aligned\}$$ We can define this operator in Physika as

``` \{.python language="python"\}
def $\hat\{p\}$($\psi$: $L^2(\mathbb\{R\})$) $\to$ $L^2(\mathbb\{R\})$:
  return -i * $\hbar$ * $\nabla$($(\psi)$)
```

It turns out that momentum like position is an unbounded operator (to
convince yourself of this fact, take the Fourier transform, in which
basis the momentum operator is multiplication by $p$). For this reason,
the momentum operator has the type

$$\begin\{aligned\}
\hat\{p\}: \mathcal\{S\}(\mathbb\{R\}) \to \mathcal\{S\}(\mathbb\{R\})
\end\{aligned\}$$

## Position and Momentum Operators in 3D

The position and momentum operators can be defined naturally in 3D by
defining operators for each componeent.

$$\begin\{aligned\}
    \hat\{r\} &= (\hat\{x\}, \hat\{y\}, \hat\{z\}) \\
    \hat\{p\} &= (\hat\{p\}_x, \hat\{p\}_y, \hat\{p\}_z)
\end\{aligned\}$$

For convenience in formulas we will often also write $$\begin\{aligned\}
    \hat\{r\} &= (\hat\{x\}_1, \hat\{x\}_2, \hat\{x\}_3) \\
    \hat\{p\} &= (\hat\{p\}_1, \hat\{p\}_2, \hat\{p\}_3)
\end\{aligned\}$$

At times, we will drop the hats for convenience in formulas.

## Canonical Commutation Relationship

As operators, position and momentum no longer necessarily commute! In
fact, the position and momentum operators obey the following commutation
relationship

$$\begin\{aligned\}
    [x_i, p_j] &= i \hbar \delta_\{ij\}
\end\{aligned\}$$ Note that we have dropped the hats from the formulas
above. Here $\delta_\{ij\}$ is the Kronecker Delta. We work through a
couple of these commutation relationships explicitly. Let's start with
the case $i = j = 1$

$$\begin\{aligned\}
    [x_1, p_1](f) &= [x, -i\hbar \frac\{\partial\}\{\partial x\}](f) \\
    &= -i\hbar x\frac\{\partial f\}\{\partial x\}  + i \hbar \frac\{\partial\}\{\partial x\} \left (x f \right) \\
    &= -i\hbar x\frac\{\partial f\}\{\partial x\}  + i \hbar f + i \hbar x \frac\{\partial f\}\{\partial x\} \\
    &= i \hbar f
\end\{aligned\}$$

Let's now consider the case $i \neq j$.

$$\begin\{aligned\}
    [x_1, p_2](f) &= [x, -i \hbar \frac\{\partial\}\{\partial y\}](f) \\
    &= -i \hbar x \frac\{\partial f\}\{\partial y\} + i \hbar \frac\{\partial\}\{\partial y\} \left (x f \right ) \\
    &= -i \hbar x \frac\{\partial f\}\{\partial y\} + i \hbar x \frac\{\partial f\}\{\partial y\} \\
    &= 0
\end\{aligned\}$$ Note that in this case, since $x$ and $y$ are
independent variables, the relationships commute with one another.

## Momentum Wave Functions

Consider the wavefunction $\psi(x)$ describing a possible state of a
quantum particle. Once you rescale $\psi$ so it is normalized, the
absolute probability density is $$\begin\{aligned\}
p(x) &= |\psi(x)|^2
\end\{aligned\}$$ for any $x$. If you look closely at the solution for the
particle in a box, the wavelength $\lambda$ is equal to $2L/n$ and the
wavefunction $$\begin\{aligned\}
\psi_n(x) &=\sqrt\{\frac\{2\}\{L\}\} \sin\left (\frac\{n \pi x\}\{L\}\right )
\end\{aligned\}$$ can be expressed as $$\begin\{aligned\}
\psi_n(x) = \sqrt\{\frac\{2\}\{L\}\}\sin \left( \frac\{ p_nx\}\{\hslash\}\right)
\end\{aligned\}$$ where $p_n$ is momentum of the particle in state $n$ and
can be expressed in terms of wavelength using the de Broglie relation
$$\begin\{aligned\}
p_n &= \frac\{h\}\{\lambda_n\}
\end\{aligned\}$$. Remember $\hslash = h/2\pi$.

The wavefunction $\psi_p(x)$ of a particle in a state of momentum $p$
can be expressed as $$\begin\{aligned\}
\psi_p(x)=e^\{ip x/\hslash\}
\end\{aligned\}$$. The subscript $p$ tells us that this wavefunction
describes a particle of definite momentum, say $p$. In quantum
mechanics, a particle of definite momentum $p$ has a definite wavelength
$\lambda$ as this function does.

This $\psi_p(x)$ is not normalized so we multiply it by a number $A$ and
choose A so that we get a normalized function $$\begin\{aligned\}
\int_\{\mathbb\{R\}\}|A|^2|e^\{\frac\{ipx\}\{\hslash\}\}|^2dx=\int_\{\mathbb\{R\}\}|A|^2dx=|A|^2L=1
\end\{aligned\}$$ where $L$ is the length of a box we consider. Hence, a
normalized state of momentum can be expressed as: $$\begin\{aligned\}
\psi_p(x)=\frac\{1\}\{\sqrt\{L\}\}e^\{\frac\{ipx\}\{\hslash\}\}
\end\{aligned\}$$

In quantum mechanics, the complete information about the particle is
given by wavefunction $\psi(x)$. Given this $\psi(x)$ we can ask where
is the particle? As discussed earlier, the answer is you can find it any
place where $\psi(x)$ is non-zero and the probability density is
$P(x)=|\psi(x)|^2$.

Similarly, we can ask what happens if we measure the particle's
momentum. The information is contained in $\psi(x)$ itself. However, it
takes more work than simply finding $|\psi(x)|^2$, which was the case
for $P(x)$.

To answer the question, we can expand thes wavefunction in terms of
Fourier series, as follows: $$\begin\{aligned\}
\psi(x) &= \sum_\{p\} A_p \frac\{e^\{\frac\{ipx\}\{\hslash\}\}\}\{\sqrt\{L\}\}\\
&=\sum_\{p\}A_p\psi_p(x)
\end\{aligned\}$$ where $A_p$ is given as $$\begin\{aligned\}
A_p=\int_\{0\}^\{L\}\frac\{1\}\{\sqrt\{L\}\}e^\{-\frac\{ipx\}\{\hslash\}\}\psi(x) dx
\end\{aligned\}$$

The probability of obtaining a value of momentum $p$ would be
$$P(p)=|A_p|^2$$

## Exercises

1.  Prove that $f(x) = \frac\{1\}\{x\}$ is in $L^2(\mathbb\{R\})$. Prove that
    $\hat\{x\}(f)$ is not in $L^2(\mathbb\{R\})$

2.  Prove that the \"eigenfunctions\" of $\hat\{x\}$ are shifted versions
    of the Diract distribution $\delta(x-x_0)$.


# Path Integral Theory of a Free Particle \{#chap:perturbation_theory\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter, we solve for the theory of a free particle using the
path integral formulation.

$$\begin\{aligned\}
(x_bt_b|x_at_a) &= \int_\{x(t_a)=x_a\}^\{x(t_b)=x_b\}\mathcal\{D\}'x \int \frac\{\mathcal\{D\}p\}\{2\pi\hbar\} \exp \left [\frac\{i\}\{\hbar\} \int_\{t_a\}^\{t_b\} dt\left ( p \dot\{x\} - \frac\{p^2\}\{2M\} \right )\right]
\end\{aligned\}$$ We can rewrite this path integral to only be in terms of
position $x$ and not in terms of momentum $p$ as well $$\begin\{aligned\}
    (x_bt_b|x_at_a) &= \int_\{x(t_a)=x_a\}^\{x(t_b)=x_b\} \mathcal\{D\}x\exp \left [ \frac\{i\}\{\hbar\} \int_\{t_a\}^\{t_b\} dt\frac\{M\}\{2\}\dot\{x\}^2\right]
\end\{aligned\}$$ We use the Feynman path integral formula
$$\begin\{aligned\}
    (x_bt_b|x_at_a) &\approx \prod_\{i=1\}^N \left [ \int_\{-\infty\}^\infty dx_n \right] \prod_\{n=1\}^\{N+1\} \left [ \int_\{-\infty\}^\infty \frac\{dp_n\}\{2\pi\hbar\} \right] \exp \left( \frac\{i\}\{\hbar\} \mathcal\{A\}^N\right)
\end\{aligned\}$$ where we define the time-sliced action $$\begin\{aligned\}
\mathcal\{A\}^N = \sum_\{n=1\}^\{N+1\} [p_n(x_n-x_\{n-1\}) - \epsilon H(p_n,x_n, t_n)]
\end\{aligned\}$$ In our case, note that $V=0$ since we are solving for a
free particle, so note that the time-sliced action becomes
$$\begin\{aligned\}
\mathcal\{A\}^N = \sum_\{n=1\}^\{N+1\} \left [ p_n(x_n - x_\{n-1\}) - \epsilon \frac\{p_n^2\}\{2M\} \right ]
\end\{aligned\}$$


# Schrodinger's Equation \{#chap:schrodinger\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\},
[\[chap:position_and_momentum\]](#chap:position_and_momentum)\{reference-type="ref+label"
reference="chap:position_and_momentum"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

We previously learned about Newton's laws, and Maxwell's equations which
respectively describe how the time evolution of classical mechanical and
electromagnetic systems proceeded. Schrodinger's equation provides an
analogous framework for describing the evolution of quantum mechanical
systems.

## Basic Formulation

Let $\psi(t)$ be the wave function of a quantum mechanical system at
time $t$. Then the wave function evolves over time according to
Schrodinger's equation, written as
$$i \hbar \frac\{d\}\{dt\}|\psi(t) \rangle = \hat\{H\}|\psi(t) \rangle$$ where
$\hat\{H\}$ is an operator, called the *Hamiltonian*, on the space of wave
functions. Given the ubiquity of the Hamiltonian in quantum mechanics we
will also often leave off the hat and use a plain $H$ for the
Hamiltonian.

What is the Hamiltonian? We described that the process of quantization
converts classical vectorial or scalar quantitites into operators. One
way of thinking about the Hamiltonian is as the quantization of the
classical energy. Recall quantization involves swapping out scalar
quantities for operators, so we describe the type of the Hamiltonian as

$$\begin\{aligned\}
H: \mathcal\{H\} \to \mathcal\{H\}
\end\{aligned\}$$

where $\mathcal\{H\}$ is the Hilbert space of wave functions. We use
$\mathcal\{H\}$ in place of concrete Hilbert spaces like $L^2(\mathbb\{R\})$
or $L^2(\mathbb\{R\}^3)$ since the Hamiltonian formalism holds true for
all of these specific choices. The intuition of Hamiltonian as the
quantized energy drives the definition of many simple Hamiltonians for
quantum systems. Let's look at an example of the usual form of a
Hamiltonian.

$$\hat\{H\} = \frac\{\hat\{p\}^2\}\{2m\} + \hat\{V\}$$ Here $\frac\{\hat\{p\}^2\}\{2m\}$
can be thought of as the kinetic energy operator and $\hat\{V\}$ as the
potential energy operator.

This equation should look familiar to you. If we undo the quantization,
this converts into the classical energy equation
$$E = \frac\{p^2\}\{2m\} + V(x)$$

We can express the Hamiltonian in Physika for the concrete Hilbert space
$L^2(\mathbb\{R\})$ as

``` \{.python language="python"\}
m : $\mathbb\{R\}^+$, V: $L^2(\mathbb\{R\})$
def $\hat\{H\}$($\psi$: $L^2(\mathbb\{R\})$) $\to$ $L^2(\mathbb\{R\})$:
  return $\hat\{p\}^2$($\psi$)/2m + V * $\psi$
```

It is important to note that the choice of Hamiltonian $\bar\{H\}$ is an
act of *modeling*. That is, while the Hamiltonian should generally
correspond to the energy for a system, in practice complex systems often
require simplifications or tweaks. When faced with a new physical
system, there is not one canonical procedure for choosing a Hamiltonian
for a physical system, but the physicist can derive a Hamiltonian that
appears to model the system from first principles or from known
Hamiltonian for simpler systems. As we will see later in this book, it
is even possible to learn an approximate Hamiltonian given sufficient
data about the evolution of a quantum system.

Let us now return to Schrodinger's equation. Rewrite it as follows
$$\frac\{\partial\}\{\partial t\} | \psi \rangle = -i \hbar \hat\{H\} | \psi(t) \rangle$$
This equation is roughly similar to an equation for gradient descent.
Very approximately the Schrodinger's equation describes a form of
gradient descent, by compelling the wave function to evolve in a way
favorable to the energy of the system.

## Forces from Schrodinger's Equation

One qualitative difference in quantum versus classical mechanics is that
we have less reason to work directly with forces. We note that it is
possible to define a force operator $$\begin\{aligned\}
\hat\{F\} &= \frac\{d\}\{dt\} \hat\{p\}
\end\{aligned\}$$ However, it turns out that the more useful quantity is
given by $$\begin\{aligned\}
    \frac\{d\}\{dt\} \langle \hat \{p\} \rangle
\end\{aligned\}$$ Ehrenfest's theorem shows that the expectation value of
the position operator evolves in a direction controlled by this modified
quantity $$\begin\{aligned\}
    m \frac\{d\}\{dt\} \langle \hat\{x\} \rangle &= \langle \hat\{p\} \rangle  \\
    \frac\{d\}\{dt\} \langle \hat\{p\} \rangle &= - \langle V'(\hat\{x\}) \rangle
\end\{aligned\}$$


# The Dirac Equation \{#chap:dirac_equation\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The Dirac equation provides a mechanism for modeling relativistic
quantum mechanical systems. Wave functions as used in the Dirac equation
are bispinors instead of the usual complex numbers seen elsewhere in
quantum mechanics.

## A Brief Introduction to Spinors

The use of spinors is needed to model the intrinsic spin of the system.
The wave-function on spacetime is consequently of the form

$$\begin\{aligned\}
    \psi: \mathbb\{R\}^\{1, 3\} \to \mathbb\{C\}^4
\end\{aligned\}$$

The space these functions live in is given by $$\begin\{aligned\}
    \mathcal\{H\} &= L^2(\mathbb\{R\}^\{1, 3\}, \mathbb\{C\}^4)
\end\{aligned\}$$

The bispinor is given by vectors in $\mathbb\{C\}^4$. The Dirac equation
itself is written in terms of a bispinor field $$\begin\{aligned\}
    \mathbb\{R\}^\{1,3\} \mapsto \mathbb\{C\}^4
\end\{aligned\}$$

## The Form of the Dirac Equation

The Dirac equation is given by $$\begin\{aligned\}
    (i \hbar \gamma^\{\mu\} \partial_\{\mu\}  - m c) \psi(x) &= 0
\end\{aligned\}$$ Here we use Einstein summation over the components $\mu$
of space-time where $$\begin\{aligned\}
\gamma^\{\mu\} : \mathbb\{C\}^\{4\times 4\}
\end\{aligned\}$$ and $\psi$ is a bispinor field $$\begin\{aligned\}
    \psi: \mathbb\{R\}^\{1,3\} \mapsto \mathbb\{C\}^4
\end\{aligned\}$$

In natural units, this equation can be rewritten as $$\begin\{aligned\}
    (i\slashed\{\partial\} - m)\psi(x) &= 0
\end\{aligned\}$$ where we define $$\begin\{aligned\}
    \slashed\{\partial\} &= \gamma^\mu \partial_\mu
\end\{aligned\}$$ The Dirac equation provides us a set of 4 coupled
partial differential equations. Note that in particular, if we apply
$(i\slashed\{partial\} + m$ as an operator to both sides of the Dirac
equation, we obtain the Klein-Gordon equation $$\begin\{aligned\}
    (i\slashed\{\partial\} - m)(i\slashed\{\partial\} + m)\psi &= 0 \\
    (\partial_\mu \partial^\mu + m^2) \psi &= 0
\end\{aligned\}$$ So each component of the Dirac equation satisfies the
Klein-Gordon equation.

## Invariances

The Dirac equation is invariant under actions of the Lorentz group. This
follows from the use of the covariant derivative $\partial_\{\mu\}$.

## Solving the Dirac Equation

When solving Dirac's equation, it is useful to start from an ansatz
about the solution $$\begin\{aligned\}
    \psi(x) &= u(p') e^\{-p \dot x\}
\end\{aligned\}$$ Here $p, x \in \mathbb\{R\}^\{1,3\}$ are 4-vectors where $p$
is the momentum. $$\begin\{aligned\}
p &= (E_p, p')    
\end\{aligned\}$$ This ansatz leads to $$\begin\{aligned\}
    (\gamma^\{\mu\} p_\{\mu\} - m)u(p')
\end\{aligned\}$$ For a particle at rest, the momentum term disappears so
we have a simplified equation

## Quantizing Dirac's Equation

Quantizing Dirac's equation becomes a good bit trickier than quantizing
the Klein-Gordon equation.


# Orbital Angular Momentum \{#chap:orbital_angular_momentum\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:spin\]](#chap:spin)\{reference-type="ref+label"
reference="chap:spin"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter, we define about the orbital angular momentum operator
$L$ and total angular momentum operator $J$. Recall that classical
angular momentum is a vector $\vec\{L\} \in \mathbb\{R\}^3$ is defined by
the cross product equation

$$\begin\{aligned\}
    \vec\{L\} &= \vec\{r\} \times \vec\{p\}
\end\{aligned\}$$

Where $\vec\{r\} \in \mathbb\{R\}^3$ is the position vector and
$\vec\{p\} \in \mathbb\{R\}^3$ is the momentum vector. To define the
analogous quantum mechanical operation, we convert these quantities into
operators.

$$\begin\{aligned\}
    L &= r \times p
\end\{aligned\}$$

Here $r$ and $p$ are the position and momentum operators. Recall that
these are vector operators

$$\begin\{aligned\}
    r &= (r_x, r_y, r_z) \\
    p &= (p_x, p_y, p_z)
\end\{aligned\}$$ Where $r_x$, $p_x$ etc are operators. Component wise,
the vector is given by $$\begin\{aligned\}
    L &= (L_x, L_y, L_z) \\
    &= (r_y p_z - r_z p_y, r_x p_z - r_z p_x, r_x p_y - r_y p_x)
\end\{aligned\}$$ Note that $L_x$, $L_y$, and $L_z$ are themselves
operators.

## Commutation Relations

The angular momentum operators satisfy the following commutation
relationships

$$\begin\{aligned\}
    [L_x, L_y] &= i \hbar L_z \\
    [L_y, L_z] &= i \hbar L_x \\
    [L_z, L_x] &= i \hbar L_y
\end\{aligned\}$$

We will prove the first of these commutation relationships explicitly
and leave the other relationships to the exercises.

$$\begin\{aligned\}
    [L_x, L_y] &= [r_y p_z - r_z p_y, ]
\end\{aligned\}$$

## Exercises

1.  Prove the other two commutation relationships $$\begin\{aligned\}
        [L_y, L_z] &= i \hbar L_x \\
        [L_z, L_x] &= i \hbar L_y
        
    \end\{aligned\}$$


# Path Integral Theory of an Oscillator \{#chap:perturbation_theory\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The action of a harmonic oscillator with mass $m$ is $$\begin\{aligned\}
    S &= \frac\{m\}\{2\} \int_\{t'\}^\{t\} ds(\dot\{w\}^2(s)-\omega^2(s) w^2(s))
\end\{aligned\}$$ Here $\omega(s)$ is a time-dependent circular frequency.
Consider the following path $$\begin\{aligned\}
S^\{(n)\}(w) &= \frac\{m\}\{2\}\sum_\{j=0\}^\{n-1\}\left [ \frac\{1\}\{\epsilon\}(w_\{j+1\}-w_j)^2 - \epsilon \omega_j^2 w_j^2 \right ] \\
w_\{j+1\} &= \omega (t' + j\epsilon)
\end\{aligned\}$$

$$\begin\{aligned\}
\xi &= (w_1,\dotsc,,w_\{n-1\}) \\
\eta &= (q', 0,\dotsc,0, q)
\end\{aligned\}$$ Then we can write action as $$\begin\{aligned\}
S^\{(n)\}(w) &= \frac\{m\}\{2\} \left ( \frac\{1\}\{\epsilon\} (\eta, \eta)  + \frac\{1\}\{\epsilon\} (\xi, C \xi) - \frac\{2\}\{\epsilon\} (\xi, \epsilon) - \epsilon \omega_0^2 (q')^2 \right )
\end\{aligned\}$$ Here $C$ is a $n-1$ dimensional matrix. The action then
reduces to computing a Gaussian integral on a discrete time lattice. The
derivation yields inthe end $$\begin\{aligned\}
K(t, q, t', q') &= \lim_\{\epsilon \to 0\} \sqrt\{\frac\{m\}\{2\pi i \hbar\}\} \frac\{1\}\{\epsilon \det C\} e^\{iS(n)(\xi)/\hbar\}
\end\{aligned\}$$


# Perturbation Theory \{#chap:perturbation_theory\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

This chapter provides an introduce to perturbation theory. Broadly
stated, perturbation theory is a technique for approximating hard to
compute quantities by adding on additional terms (perturbations) to
simpler physical theories. Perturbation theory is related to classical
approximation techniques such as Taylor series expansions, but with the
crucial difference that perturbation theory techniques may sometimes be
fruitfully used for divergent series.

## Time Independent Perturbation Theory

Suppose that we have a time independent Hamiltonian $H$ that can be
written as $$\begin\{aligned\}
    H &= H_0 + \epsilon V
\end\{aligned\}$$ Assume that for $H_0$ we have solved for the eigenvalues
and eigenstates of the operator (for example, $H_0$ may be a simple
system like the Harmonic oscillator.) We then seek solutions to $H$
starting from solutions to $H_0$ and expanding in powers of $\epsilon$


# Creation and Annihilation Operators \{#chap:creation_annihilation\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\},
[\[chap:quantum_harmonic\]](#chap:quantum_harmonic)\{reference-type="ref+label"
reference="chap:quantum_harmonic"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter, we introduce a powerful mathematical technique that
arises repeatedly in quantum systems: creation and annihilation
operators. An annihilation operator is denoted $\hat\{a\}$ lowers the
number of particles in a state by 1. A creation operator
$\hat\{a\}^\{\dagger\}$ raises the number of particles by 1. Let's derive
these operators in the context of the quantum harmonic oscillator we
studied in
[\[chap:quantum_harmonic\]](#chap:quantum_harmonic)\{reference-type="ref+label"
reference="chap:quantum_harmonic"\}.

$$\left (-\frac\{\hbar^2\}\{2m\}\frac\{d^2\}\{dx^2\} + \frac\{1\}\{2\}m\omega^2 x^2 \right ) \psi = E \psi$$
Making a change of coordinates $$x = \sqrt\{\frac\{\hbar\}\{m\omega\}\}q$$
Note that this means $$\begin\{aligned\}
    dx &= \sqrt\{\frac\{\hbar\}\{m\omega\}\}dq \\
    \frac\{dq\}\{dx\} &= \sqrt\{\frac\{m\omega\}\{\hbar\}\} 
\end\{aligned\}$$ Plugging this into the change of variables, we have
$$\begin\{aligned\}
    \frac\{d^2\}\{dx^2\} &= \left (\frac\{dq\}\{dx\} \right)^2 \frac\{d\}\{dq^2\} \\ 
    \frac\{d^2\}\{dx^2\} &= \frac\{m\omega\}\{\hbar\} \frac\{d\}\{dq^2\}    
\end\{aligned\}$$ Substituting into the equation above, we get
$$\frac\{\hbar \omega\}\{2\} \left ( - \frac\{d^2\}\{dq^2\} + q^2 \right ) \psi(q) = E \psi(q)$$
The following factorization trick proves useful:
$$\left (-\frac\{d\}\{dq^2\} + q^2 \right) = \left (-\frac\{d\}\{dq\} + q\right )\left (\frac\{d\}\{dq\} + q \right) + \frac\{d\}\{dq\} q - q \frac\{d\}\{dq\}$$
Let's apply the second part of this to an arbitrary function $f$
$$\begin\{aligned\}
    \left (\frac\{d\}\{dq\} q - q \frac\{d\}\{dq\} \right ) f &= \frac\{d\}\{dq\}(qf(q)) - q\left(\frac\{df(q)\}\{dq\} \right )\\
    &= f(q) + q\frac\{df(q)\}\{dq\} - q\frac\{df(q)\}\{dq\} \\
    &= f(q)
\end\{aligned\}$$ Which implies that
$$\frac\{d\}\{dq\} q - q\frac\{d\}\{dq\} = 1$$ It follows that
$$-\frac\{d^2\}\{dq^2\} + q^2 = \left (-\frac\{d\}\{dq\} + q \right ) \left (\frac\{d\}\{dq\} + q \right )  + 1$$
Now define
$$\hat\{a\}^\{\dagger\} = \frac\{1\}\{\sqrt\{2\}\}\left ( -\frac\{d\}\{dq\} + q \right )$$
and $$\hat\{a\}^ = \frac\{1\}\{\sqrt\{2\}\} \left ( \frac\{d\}\{dq\} + q \right )$$
Then we can rewrite Schrodinger's equation as

$$\hbar \omega (\hat\{a\}^\{\dagger\} \hat\{a\} + \frac\{1\}\{2\}) \psi = E \psi$$


# Spin \{#chap:spin\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Spin is a quantum mechanical analog to angular momentum. We will study
spin in the context of a two level quantum system.

### The Two-Level System

An atom with only two energy eigenvalues represents an orthonormal
systems and is described by a two-dimensional state space spanned by the
two energy eigenstates $|e\rangle$ and $|g\rangle$, where $e$ represents
the excited state (higher energy) and $g$ represents the ground state.
The corresponding energy eigenvalues are $E_e$ and $E_g$ (figure
[\[fig:twoLevelSystem\]](#fig:twoLevelSystem)\{reference-type="ref"
reference="fig:twoLevelSystem"\}). The two states states correspond to
the wave functions in the position (denote by $x$) representation.
$$\psi_g(x)=\langle x|g\rangle$$ $$\psi_e(x)=\langle x|e\rangle$$

::: marginfigure
![image](figures/Physics/quantum_mechanics/spin/2level system.png)\{width="50%"\}
:::

The Hamiltonian operator of the two-level atom is in the energy
representation $$\begin\{aligned\}
    \hat\{H\} = E_e|e\rangle\langle e|+E_g|e\rangle\langle g|
\end\{aligned\}$$ In this two-dimensional state space only 4 ($2\times 2$)
linearly independent linear operators are possible. A possible choice
for an operator base in this space is $$\begin\{aligned\}
    I &=|e\rangle\langle e|+|e\rangle\langle g|\\ 
    \sigma_\{z\} &=|e\rangle\langle e|-|e\rangle\langle g| \\
    \sigma^\{+\} &=|e\rangle\langle g| \\
    \sigma^\{-\} &=|e\rangle\langle e|
\end\{aligned\}$$

The non-Hermitian operators $\sigma^\pm$ could be replaced by the
Hermitian operators $\sigma_\{x,y\}$ $$\sigma_x=\sigma^+ +\sigma^-$$
$$\sigma_y=-j\sigma^+ +j\sigma^-$$ The physical meaning of these
operators becomes obvious, if we look at the action when applied to an
arbitrary state $$|\psi\rangle =c_g |g\rangle + c_e |e\rangle$$

Therefore, we obtain $$\sigma^+|\psi\rangle=c_g|e\rangle$$
$$\sigma^-|\psi\rangle=c_e|g\rangle$$
$$\sigma_z|\psi\rangle=c_e|e\rangle-c_g|g\rangle$$

The operator $\sigma^+$ generates a transition from the ground to the
excited state, and $\sigma^-$ does the opposite. In contrast to
$\sigma^+$ and $\sigma^-$, $\sigma_z$ is a Hermitian operator, and its
expectation value is an observable physical quantity with expectation
value $$\langle\psi|\sigma_z|\psi\rangle = |c_e|^2-|c_g|^2=w$$ the
inversion $w$ of the atom, since $|c_e|^2$ and $|c_g|^2$ are the
probabilities for finding the atom in state $|e\rangle$ or $|g\rangle$
upon a corresponding measurement. If we consider an ensemble of $N$
atoms the total inversion would be $W =
N \langle\psi|\sigma_z|\psi\rangle$. If we separate from the Hamiltonian
the term $(E_e +
E_g)/2 ·I$, where $I$ denotes the unity matrix, we rescale the energy
values correspondingly and obtain for the Hamiltonian of the two-level
system $$\begin\{aligned\}
\hat\{H\}=\frac\{1\}\{2\}\hbar\omega_\{eg\}\sigma_z
\end\{aligned\}$$ with the transition frequency $$\begin\{aligned\}
    \omega_\{eg\}=\frac\{1\}\{\hbar\}(E_e-E_g)
\end\{aligned\}$$ There are the following commutator relations between
operators $$\begin\{aligned\}
    [\sigma^+,\sigma^-,]_+ &=\sigma_z \\
    [\sigma^+,\sigma_z,]_+ &=0 \\
    [\sigma^-,\sigma_z,]_+ &=0 \\
    [\sigma^-,\sigma^-,]_+ &=[\sigma^+,\sigma^+,]_+=0
\end\{aligned\}$$ The operators $\sigma_x$, $\sigma_y$, $\sigma_z$ fulfil
the angular momentum commutator relations $$\begin\{aligned\}
    [\sigma_x,\sigma_y]&=\mathrm\{2j\}\sigma_z \\
    [\sigma_y,\sigma_z]&=\mathrm\{2j\}\sigma_x \\
    [\sigma_z,\sigma_x]&=\mathrm\{2j\}\sigma_y 
\end\{aligned\}$$ The two-dimensional state space can be represented as
vectors in $\mathbb\{C\}^2$ according to the rule: $$\begin\{aligned\}
    |\psi\rangle=c_g|g\rangle+c_e|e\rangle \longrightarrow \{c_e \choose c_g\} 
\end\{aligned\}$$ The operators are then represented by matrices
$$\begin\{aligned\}
    \sigma^+ &\longrightarrow \begin\{pmatrix\}
0 & 1 \\
0 & 0 
\end\{pmatrix\} \\
    \sigma^- &\longrightarrow \begin\{pmatrix\}
0 & 0 \\
1 & 0 
\end\{pmatrix\} \\
\sigma_z &\longrightarrow \begin\{pmatrix\}
1 & 0 \\
0 & -1 
\end\{pmatrix\} \\
I &\longrightarrow \begin\{pmatrix\}
1 & 0 \\
0 & 1
\end\{pmatrix\} 
\end\{aligned\}$$

## Spin Matrices

Generalizing the discussion above, for spin-$\frac\{1\}\{2\}$ systems, the
spin operators are given by

$$\begin\{aligned\}
    S_x &= \frac\{\hbar\}\{2\} \sigma_x \\
    S_y &= \frac\{\hbar\}\{2\} \sigma_y \\
    S_z &= \frac\{\hbar\}\{2\} \sigma_z
\end\{aligned\}$$ where $\sigma_i$ is a Pauli matrix.

## Commutation Relations

The spin operators $S_i$, $S_j$, $S_k$ obey the following commutation
rules

$$\begin\{aligned\}
    [S_j, S_k] &= i \hbar \varepsilon_\{jkl\} S_l
\end\{aligned\}$$ Where $\varepsilon_\{jkl\}$ is the Levi-Civita symbol.


# Path Integrals \{#chap:path_integrals\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Path integral techniques provide a method of computing transition
amplitudes for sophisticated quantum mechanical systems. Path integrals
are useful in standard quantum mechanics, but invaluable in quantum
field theory as we will learn in future chapters.

The propagator defines the amplitude of transition from quantum state
$q$ at time $0$ to $q'$ at time $T$ according to Hamiltonian $\hat\{H\}$
$$K(q', T, q, 0) = \left \langle q' \middle |e^\{-i\hat\{H\} T\} \middle | q \right \rangle$$
The propagator in theory defines the complete time evolution of a
quantum system. The challenge in practice though is that the operator
exponential $e^\{-i\hat\{H\}t\}$ is likely very complicated and infeasible
to compute. Let's expand the Taylor series of this operator
$$e^\{-i\hat\{H\}t\} = 1 - i\hat\{H\}t - \hat\{H\}^2 t^2 + \cdots$$ If the time
$t$ is small, we can use the linear Taylor expansion to compute the
propagator as
$$K(q', t, q, 0) \approx \langle q' | q \rangle - it \langle q' | H | q \rangle$$
Is there a way we can break down our more complex propagator $K$ using
this linear Taylor expansion? To this, recall that if $\{|q_i\rangle \}$
is an orthonormal basis for Hilbert space $\mathcal\{H\}$ then
$$\sum_i | q_i \rangle \langle q_i | = I$$ Take our orthonormal basis to
be the set of eigenstates of the position operator. Since there are
uncountably many such operators, we will write this identity equation as
$$\int dq | q \rangle \langle q | = I$$ We can split apart the matrix
exponential as follows (this is valid since $\hat\{H\}$ commutes with
itself).
$$e^\{-i\hat\{H\}T\} = e^\{-i\hat\{H\}\frac\{T\}\{2\}\} e^\{-i\hat\{H\}\frac\{T\}\{2\}\}$$
Note that using this identity, we can perform the calculation

$$\begin\{aligned\}
    K(q', T, q, 0) &= \left \langle q' \middle | e^\{-i\hat\{H\} T\} \middle | q \right \rangle \\
    &= \left \langle q' \middle | e^\{-i\hat\{H\} \frac\{T\}\{2\}\} e^\{-i\hat\{H\} \frac\{T\}\{2\}\} \middle | q \right \rangle \\
    &=  \langle q'  | e^\{-i\hat\{H\} \frac\{T\}\{2\}\} \int dq_1 | q_1 \rangle \langle q_1 | e^\{-i\hat\{H\} \frac\{T\}\{2\}\}  | q  \rangle \\
    &= \int dq_1 \langle q'  | e^\{-i\hat\{H\} \frac\{T\}\{2\}\}  | q_1 \rangle \langle q_1 | e^\{-i\hat\{H\} \frac\{T\}\{2\}\}  | q  \rangle \\
    &= \int dq K\left (q', T, q_1, \frac\{T\}\{2\} \right ) K\left (q_1, \frac\{T\}\{2\}, q, 0 \right )
\end\{aligned\}$$ Now let $\delta = T/N$. You will show in the exercises
$$K(q',T, q, 0) = \int dq_1 \cdots dq_n K_\{q', q_\{n\}\} \cdots K_\{q_1, q\} 
    \label\{pathexpansion\}$$ where
$K_\{q_i, q_\{i-1\}\} = K(q_i, i\delta, q_\{i-1\}, (i-1)\delta)$

![Diagrammatic Expansion of
Paths.](figures/Physics/quantum_mechanics/path_integrals/Expansion of Paths (1).png)\{#fig:path_integral
width="\\linewidth"\}

You can intuitively think of this expansion as traveling over all
possible paths from $q$ to $q'$.

``` \{.python language="python"\}

sample_path : Rand[$\mathbb\{R\}^3 \to \mathbb\{R\}^3$]
path_prob: ($\mathbb\{R\}^3 \to \mathbb\{R\}^3$) $\to$ $\mathbb\{R\}$

def path_integral(q: $\mathbb\{R\}^3$, s: $\mathbb\{R\}^3$): $\mathbb\{C\}$
  amplitude = 0
  for i in range(N):
    path = sample_path(q, s)
    amplitude += path_prob(path)
  return amplitude
```

### Exercises

1.  Prove that the eigenfunctions of the position operator $\hat\{x\}$ are
    given by the Dirac delta functions $\delta_\{x_0\} = \delta(x - x_0)$.

2.  Prove the expansion equation for paths given in Equation
    [\[pathexpansion\]](#pathexpansion)\{reference-type="ref"
    reference="pathexpansion"\}.

## 


# Schrodinger's Equation in Three Dimensions \{#chap:schrodinger_3D\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter, we study techniques for solving Schrodinger's equation
in three dimensions. We can write the equation as

$$\begin\{aligned\}
-\frac\{\hbar^2\}\{2m\}\left [ \frac\{\partial\}\{\partial x^2\} + \frac\{\partial\}\{\partial y^2\} + \frac\{\partial\}\{\partial z^2\}\right ] \psi(x, y, z) + V(x, y, z) \psi(x, y,z) &= E \psi(x, y, z) \\
-\frac\{\hbar^2\}\{2m\} \nabla^2 \psi + V \psi &= E \psi
\end\{aligned\}$$

## Moving to Spherical Coordinates

The three dimensional Schrodinger's equation becomes easier to solve in
spherical coordinates. A technical challenge to performing this
operation is that we need to represent the Laplacian operator $\nabla^2$
in spherical coordinates. Let us introduce the change of variables

$$\begin\{aligned\}
    u &= u(x, y, z) \\
    v &= v(x, y, z) \\
    w &= w(x, y, z)
\end\{aligned\}$$ In reverse we can write $$\begin\{aligned\}
    x &= x(u, v, w) \\
    y &= y(u, v, w) \\
    z &= z(u, v, w)
\end\{aligned\}$$

Let $$\begin\{aligned\}
    r = (x, y, z)
\end\{aligned\}$$ Then we write $$\begin\{aligned\}
    dr &= (dx, dy, dz)
\end\{aligned\}$$ We can also write $$\begin\{aligned\}
    dr &= \frac\{\partial r\}\{\partial u\} du + \frac\{\partial r\}\{\partial v\} dv + \frac\{\partial r\}\{\partial w\} dw
\end\{aligned\}$$

We write $$\begin\{aligned\}
    h_u &= \left | \frac\{\partial r\}\{\partial u\} \right | \\
    h_v &= \left | \frac\{\partial r\}\{\partial v\} \right | \\
    h_w &= \left | \frac\{\partial r\}\{\partial w\} \right | 
\end\{aligned\}$$

These terms are typically referred to as scale factors. The gradient
term in the $(u, v, w)$ coordinate system is then given by

$$\begin\{aligned\}
\nabla &= \left ( \frac\{1\}\{h_u\} \frac\{\partial\}\{\partial u\}, \frac\{1\}\{h_v\} \frac\{\partial\}\{\partial v\}, \frac\{1\}\{h_w\} \frac\{\partial\}\{\partial w\} \right )
\end\{aligned\}$$ For the specific case of spherical coordinates, we have
a coordinate system $(r, \theta, \phi)$ defined by the relationship
$$\begin\{aligned\}
x &= r \cos \theta \sin \phi
\end\{aligned\}$$ We can then compute that the gradient operator is given
by $$\begin\{aligned\}
\nabla &= \left ( \frac\{\partial\}\{\partial r\}, \frac\{1\}\{r \sin \phi\} \frac\{\partial\}\{\partial \theta\}, \frac\{1\}\{r\} \frac\{\partial\}\{\partial \phi\} \right) 
\end\{aligned\}$$

Computing the divergence operator in curvilinear coordinates is more
difficult. The general formula which we do not prove is given by
$$\begin\{aligned\}
\nabla \cdot f &= \left ( h_u h_v h_w \right ) \left ( \frac\{\partial\}\{\partial u\} \left ( h_v h_w  x \right) + \frac\{\partial\}\{\partial v\} \left ( h_u h_w  y \right) + \frac\{\partial\}\{\partial w\} \left ( h_u h_v  z \right) \right )
\end\{aligned\}$$

Combining this formula with the previous formula allows for the
derivation of the spherical Laplacian equation we use in the next
section.

## Solving the Equation

For simplicity, we assume that the system we are modeling is time
independent. In this case, Schrodinger's equation takes the form

$$\begin\{aligned\}
-\frac\{\hbar^2\}\{2m\} \nabla^2 \psi + V \psi = E \psi
\end\{aligned\}$$

We use the spherical form of the Laplacian

$$\begin\{aligned\}
    \nabla^2 = \frac\{1\}\{r^2\} \frac\{\partial\}\{\partial r\} \left ( r^2 \frac\{\partial\}\{\partial r\} \right) + \frac\{1\}\{r^2 \sin \theta\} \frac\{\partial\}\{\partial \theta\} \left ( \sin \theta \frac\{\partial\}\{\partial \theta\} \right ) + \frac\{1\}\{r^2 \sin^2 \theta\} \left ( \frac\{\partial^2\}\{\partial \phi^2\}\right )
\end\{aligned\}$$

Plugging this into Schrodinger's equation, we obtain

$$\begin\{aligned\}
    -\frac\{\hbar^2\}\{2m\} \left [ \frac\{1\}\{r^2\} \frac\{\partial\}\{\partial r\} \left ( r^2 \frac\{\partial \psi\}\{\partial r\} \right) + \frac\{1\}\{r^2 \sin \theta\} \frac\{\partial \}\{\partial \theta\} \left ( \sin \theta \frac\{\partial \psi\}\{\partial \theta\} \right ) + \frac\{1\}\{r^2 \sin^2 \theta\} \left ( \frac\{\partial^2 \psi\}\{\partial \phi^2\}\right ) \right ] + V \psi = E\psi
\end\{aligned\}$$

$\psi$ is now a function of the three variables $(r, \theta, \psi)$ and
Schrodinger's equation becomes a partial differential equation in these
three variables. To solve this equation we look to separation of
variables. In particular, we hypothesize the following form for
solutions

$$\begin\{aligned\}
    \psi(r, \theta, \phi) &= R(r)Y(\theta, \phi)
\end\{aligned\}$$

Here $R(r)$ is the radial component of the solution and $Y(\theta,\phi)$
is the angular component. Using this ansatz, Schrodinger's equation
reduces to solving two separate ordinary differential equations.


# Heisenberg Formulation \{#chap:schrodinger\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:quantum_mechanics\]](#chap:quantum_mechanics)\{reference-type="ref+label"
reference="chap:quantum_mechanics"\},
[\[chap:position_and_momentum\]](#chap:position_and_momentum)\{reference-type="ref+label"
reference="chap:position_and_momentum"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The Heisenberg formulation provides an alternative mathematical
representation to the Schrodinger formulation that centers evolution of
operators instead of evolution of state vectors. In the Schrodinger
evolution we might say that a system evolves by a unitary transformation
$U$ meaning that $$\begin\{aligned\}
    |\alpha\rangle \mapsto U|\alpha \rangle
\end\{aligned\}$$ Note that unitary transformations preserve the inner
product so that we have $$\begin\{aligned\}
\langle \alpha | \beta \rangle &\mapsto \langle \alpha | U^\dagger U | \beta \rangle \\
&= \langle \alpha | \beta \rangle
\end\{aligned\}$$ Suppose now that we have an arbitrary operator $X$. How
does this operator evolve under unitary evolution? $$\begin\{aligned\}
    \langle \alpha | X | \beta \rangle \mapsto \langle \alpha U^\dagger X U | \beta \rangle 
\end\{aligned\}$$ This suggests that the operator $X$ evolves by the
following rule $$\begin\{aligned\}
    X \mapsto U^\dagger X U
\end\{aligned\}$$ Suppose now that $A$ is an observable in the Schrodinger
formulation. We can apply this rule to retrieve the observable in the
Heisenberg formulation $$\begin\{aligned\}
    A^H(t) \mapsto U^\dagger(t) A U(t)
\end\{aligned\}$$ Note that $A^H(t)$ varies in time. we can then obtain
what is called the Heisenberg equation of motion by differentiation
$$\begin\{aligned\}
    \frac\{dA^H(t)\}\{dt\} &= \frac\{i\}\{\hbar\} [H_H, A_H(t)] + \left (\frac\{\partial A_S\}\{\partial t\} \right )_H \\
    &= \frac\{1\}\{i\hbar\}[A^H, U^\dagger U U] \\
    &= \frac\{1\}\{i\hbar\}[A^H, H]
\end\{aligned\}$$


# Feynman Path Integrals \{#chap:path_integrals\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

[TODO: This is notes from Shankar. Unify with other path integral
chapter.]\{style="color: red"\} In the last chapter we studied the
structure of a path integral for a general abstract Hamiltonian. In this
chapter, we assume that the Hamiltonian has concrete form
$$\begin\{aligned\}
    H &= \frac\{P^2\}\{2m\} + V(X)
\end\{aligned\}$$ Recall the Baker-Campbell Hausdorff Formula
$$\begin\{aligned\}
    e^\{A\}e^\{B\} &= e^\{A + B + \frac\{1\}\{2\}[A, B]+\dotsc\}
\end\{aligned\}$$

[TODO: There's some finicky convergence thing here about infinite
dimensions.]\{style="color: red"\} We can write the time evolution
operator for an infinitesimal time $\varepsilon$ as $$\begin\{aligned\}
    U &= \exp \Bigg [ -\frac\{i\varepsilon\}\{\hbar\} (P^2/2m + V(X)) \Bigg ]
\end\{aligned\}$$ Note that then $$\begin\{aligned\}
    \exp \Bigg[ -\frac\{i\varepsilon\}\{2m\hbar\} P^2 \Bigg ] \cdot \exp \Bigg[ -\frac\{i\varepsilon\}\{\hbar\} V(X) \Bigg ]  &= 
    \exp \Bigg [ -\frac\{i\varepsilon\}\{2m\hbar\}P^2 - \frac\{i\varepsilon\}\{\hbar\}V(X) + \frac\{-\varepsilon^2\}\{2m\hbar^2\} [P^2, V(X)] + \dotsc \Bigg ]
\end\{aligned\}$$ The square of two infinitesimal quantities is assumed to
be $0$. [TODO: Perhaps introduce nonstandard analysis in a
chapter.]\{style="color: red"\}. We would like to compute the propagator
$$\begin\{aligned\}
\langle x' | U x \rangle &\approx \langle x' | \left (e^\{-\frac\{i\varepsilon\}\{2m\hbar\}\}e^\{-\frac\{i\varepsilon\}\{\hbar\}V(X)\}\right )^N | x \rangle
\end\{aligned\}$$

[TODO: Flesh out with the insertion of n-decompositions of identity as
in the previous chapter]\{style="color: red"\}
