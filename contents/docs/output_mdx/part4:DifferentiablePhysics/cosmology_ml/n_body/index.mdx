# Cosmological N-Body Simulations \{#chap:n_body\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:molecular_hamiltonian\]](#chap:molecular_hamiltonian)\{reference-type="ref+label"
reference="chap:molecular_hamiltonian"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

N-body simulations provide powerful tools in cosmology to study models
of dark matter. These simulations can require evolving billions of
particles over very long timescales.

## The Particle Mesh Scheme

This scheme gets the $(N, 3)$ input tensor of the positions of $N$
particles.

Time evolution is given by the equation

$$\begin\{aligned\}
\frac\{dx\}\{da\} &= \frac\{1\}\{a^3 E(a)\} v \\
\frac\{dv\}\{da\} &= \frac\{1\}\{a^2 E(a)\}  F_\theta(x, a) 
\end\{aligned\}$$

$$\begin\{aligned\}
F_\theta(x, a) &= \frac\{3 \Omega_m\}\{2\} \nabla \left [ \phi_\{PM\}(x) * \mathcal\{F\}^\{-1\}(1+f_\theta(a, |k|)) \right ]
\end\{aligned\}$$

## Convolutional Approximations

The core idea is to use a convolutional network to approximate the rapid
time evolution of the simulation.
