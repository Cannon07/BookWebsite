# Smooth Overlap of Atomic Positions \{#chap:soap\}

------------------------------------------------------------------------

\
**Prerequisites:** [\[chap:dft\]](#chap:dft)\{reference-type="ref+label"
reference="chap:dft"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The smooth overlap of atomic positions proposes a kernel method which
uses a similarity notion between atomic neighborhoods to construct
estimates of energies.

## Mathematical Framework

The similarity of two atomic environments is given by the formula

$$\begin\{aligned\}
S(\rho, \rho') &= \int \rho(r) \rho'(r) dr
\end\{aligned\}$$ We can transform this definition into a rotationally
invariant kernel by integrating over all choices of rotation matrix
$$\begin\{aligned\}
k(\rho, \rho') &= \int \left | S(\rho, R \rho') \right |^n  dR \\
&= \int \left | \int \rho(r) \rho'(R r)\right |^n  dR
\end\{aligned\}$$

The atomic densities are constructed as a sum of atom centered Gaussians
$$\begin\{aligned\}
\rho(r) &= \sum_i \exp(-\alpha |r - r_i|^2)
\end\{aligned\}$$ We can use the fact that the spherical harmonics provide
an orthogonal basis to expand $$\begin\{aligned\}
\exp(-\alpha|r - r_i|^2) &= \sum_\{lm\} c^i_\{lm\} Y_\{lm\}(r)
\end\{aligned\}$$ The overlap kernel can then be computed directly in
terms of Wigner-D matrices using the fact that these matrices act on
spherical harmonics in a structured way.

The full SOAP kernel is typically normalized as well

$$\begin\{aligned\}
K(\rho, \rho') &= \left (\frac\{k(\rho,\rho')\}\{\sqrt\{k(\rho, \rho)k(\rho', \rho')\}\} \right )^\zeta
\end\{aligned\}$$

This kernel method turns out to correspond directly to some of the
featurization methods we have seen previously. However, the choice of a
general kernel reduces some of the overhead associated with this system.

## Exercises

1.  
