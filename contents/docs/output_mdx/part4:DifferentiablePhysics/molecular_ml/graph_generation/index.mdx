# Sampling from Molecular Space \{#chap:graph_generation\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:graphconvs\]](#chap:graphconvs)\{reference-type="ref+label"
reference="chap:graphconvs"\},
[\[chap:equivariant_networks\]](#chap:equivariant_networks)\{reference-type="ref+label"
reference="chap:equivariant_networks"\},
[\[chap:molecular_dynamics\]](#chap:molecular_dynamics)\{reference-type="ref+label"
reference="chap:molecular_dynamics"\},
[\[chap:dft\]](#chap:dft)\{reference-type="ref+label"
reference="chap:dft"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

The distribution of all possible molecules is very complex. Studies have
indicated that the number of possible \"small\" molecules is
astronomically large. As a result, mathematical studies of such a space
have been very limited until recent years. Differentiable programming
methods have enabled new approaches to systematically sample from this
distribution. In this chapter, we review a few techniques for sampling
from molecular distributions.

## String Generation Methods

As we learned previously, molecular formulas can be represented as
string structures (in SMILES or SELFIES formats). Early methods for
sampling molecular space adapt methods from natural language processing
to directly generate samples of the underlying string space. One
limitation of these approaches was that many syntactically valid SMILES
strings did not correspond to chemically valid molecules. New approaches
focus on learning to decode within the semantically constrained SELFIES
langauge which bypasses the problem by guaranteeing that syntactically
valid strings correspond to chemically viable compounds.

## Graph Generation Methods

A popular family of methods uses algorithmic methods to assemble
molecular graphs piece by piece. Some techniques perform direct assembly
by modifying simple building blocks on the molecule. However, such
techniques tend to have limited capacity to construct more complex
molecules. Newer approaches utilize hierarchical methods to use larger
graph motifs within construction.

``` \{.python language="python"\}
class MolecularNormalizingFlow(NormalizingFlow):
  
  
  def $\lambda$(X: String[N]):
    onehot = OneHotEncode(X)
    return nf(onehot)
```
