# Variational Principle \{#chap:quantum_variational\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:schrodinger\]](#chap:schrodinger)\{reference-type="ref+label"
reference="chap:schrodinger"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Suppose that $H$ is a Hamiltonian which is too complex to allow for
direct solution of Schrodinger's equation. The variational principle
provides a method to construct structured approximations to the solution
of $H$ by leveraging a lower bound inequality on the energy of the
system.

## The Variational Principle

The variational principle states that for any normalized wave function
$\psi$, we have that

$$\begin\{aligned\}
E \leq \langle \psi | H | \psi \rangle 
\end\{aligned\}$$

Here $E$ is the ground state energy for the Hamiltonian. To see this,
note that the eigenfunction of $H$ form a complete basis for the base
Hilbert space $\mathcal\{H\}$.

Let us denote these wave functions as $\psi_i$ with associated energies
$E_i$. Then we can expand any potential wave function as
$$\begin\{aligned\}
    \psi &= \sum_i c_i \psi_i
\end\{aligned\}$$ We can then compute $$\begin\{aligned\}
    \langle \psi | H | \psi \rangle &= \Big \langle \sum_i c_i \psi_i \Big | H \Big | \sum_j c_j \psi_j \Big  \rangle \\
    &= \Big \langle \sum_i c_i \psi_i \Big | \sum_j c_j E_j \psi_j \Big \rangle \\
    &= \sum_\{ij\} c^*_i c_j E_j \langle \psi_i | \psi_j \rangle \\
    &= \sum_\{i\} |c_i|^2 E_i \\
    &\geq E_\{\textrm\{ground\}\}
\end\{aligned\}$$

By choosing different guesses for $\psi$ and computing
$\langle \psi | H | \psi \rangle$ we can upper bound the ground state
quantum energy of the system. In the case that our guess is not
normalized, we replace the inequality above with the normalized version
$$\begin\{aligned\}
    E_\{\textrm\{ground\}\} \leq \frac\{\langle \psi | H | \psi \rangle \}\{\langle \psi | \psi \rangle\}
\end\{aligned\}$$

## Variational Monte Carlo

The basic variational approach can be applied analytically for simple
systems, but larger quantum mechanical systems require the use of
numerical techniques. Suppose that have a parameterized wave function

$$\begin\{aligned\}
    \psi(\theta)
\end\{aligned\}$$

where $\theta$ is some set of parameters. We write $$\begin\{aligned\}
    E_\theta &= \frac\{\langle \psi(\theta) | H | \psi(\theta) \rangle \}\{\langle \psi(\theta) | \psi(\theta) \rangle\}
\end\{aligned\}$$ Note that the denominator can be written as
$$\begin\{aligned\}
   \langle \psi(\theta) | \psi(\theta) \rangle &= \int \psi^*(\theta) \psi(\theta) dx \\
   &= \int \|\psi(\theta)\|^2 dx
\end\{aligned\}$$ The numerator can be written as

$$\begin\{aligned\}
    \langle \psi(\theta) | H | \psi(\theta) \rangle &= \int \psi^*(\theta) H \psi(\theta) dx \\
    &= \int \|\psi(\theta)\|^2 \frac\{H \psi(\theta)\}\{\psi(\theta)\} dx
\end\{aligned\}$$ Combining, we can write $$\begin\{aligned\}
    E_\{\theta\} &= \frac\{\int \|\psi(\theta)\|^2 \frac\{H\psi(\theta)\}\{\psi(\theta)\} dx\}\{\int \|\psi(\theta)\|^2 dx\} \\
    &= \int \frac\{\|\psi(\theta)\|^2\}\{\int \|\psi(\theta)\|^2 dx\} \frac\{H\psi(\theta)\}\{\psi(\theta)\} dx
\end\{aligned\}$$ We define $$\begin\{aligned\}
    q(\theta) &= \frac\{\|\psi(\theta)\|^2\}\{\int \|\psi(\theta)\|^2 dx\}
\end\{aligned\}$$ and note that $q$ is a probability distribution. So we
can write $$\begin\{aligned\}
    E_\theta &= \int q(\theta) \frac\{H \psi(\theta)\}\{\psi(\theta)\} \\ 
    &= E_q \left [\frac\{H \psi(\theta)\}\{\psi(\theta)\} \right ]
\end\{aligned\}$$

By sampling from $q$, this expectation can be computed numerically
$$\begin\{aligned\}
    E_\theta \approx \frac\{1\}\{N\} \sum_i \frac\{H\psi(\theta)(x_i)\}\{\psi(\theta)(x_i)\}, \quad x_i \sim q(\theta)
\end\{aligned\}$$

By varying choice of $\theta$, we can improve the lower bound
$E_\theta$. The choice of $\psi(\theta)$ is critical for these
approximations. A simple choice is to do a direct factorization. For
example, for a system with $N$ electrons,

$$\begin\{aligned\}
    \psi(X) &= \psi(x_1)\psi(x_2)\dotsc \psi(x_n)
\end\{aligned\}$$ A more sophisticated decomposition makes use of what is
called a Jastrow factor $$\begin\{aligned\}
    \psi(X) &= \exp \left ( \sum_\{ij\} u(r_\{ij\}) \right )
\end\{aligned\}$$
