# Density Functional Theory \{#chap:dft\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:molecular_hamiltonian\]](#chap:molecular_hamiltonian)\{reference-type="ref+label"
reference="chap:molecular_hamiltonian"\},
[\[chap:quantum_variational\]](#chap:quantum_variational)\{reference-type="ref+label"
reference="chap:quantum_variational"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Let us posit that the quantum mechanical description of a system is
completely defined by its wave function $$\begin\{aligned\}
\psi &= \psi\left(r_1,\dotsc, r_N, R_1,\dotsc, R_K, t \right),
\end\{aligned\}$$

which is a function of time $t$, electron coordinates
$\left\{ \ec \right\}$ and nuclear coordinates $\left\{ \nc \right\}$.
The wave function satisfies the time dependent Schrödinger equation
$$\begin\{aligned\}
\hat\{H\} \psi = i \frac\{\partial\}\{\partial t\} \psi , 
\end\{aligned\}$$ where $\hat\{H\}$ is the Hamiltonian operator. In
coordinate representation, the Hamiltonian is given by $$\begin\{aligned\}
\hat\{H\} &=
-\frac\{1\}\{2\}\sum_\{i=1\}^\{N\} \nabla _i^2
-\sum_\{k=1\} ^\{K\} \frac\{1\}\{2M_k\} \nabla _k^2
-\sum_\{i=1\}^\{N\} \sum_\{k=1\} ^\{K\} \frac\{Z_k\}\{\left|r_i -R_k\right|\} \\
& \qquad 
+\frac\{1\}\{2\} \sum_\{i\neq j\}^N\frac\{1\}\{\left|r_i -r_j\right|\} 
+\frac\{1\}\{2\} \sum_\{k\neq l\}^K\frac\{Z_k Z_l\}\{\left|R_k -R_l\right|\}. 
\end\{aligned\}$$ The first term is the kinetic energy of the electrons,
the second term is the kinetic energy of the nuclei, the third term is
the interaction between the electrons and the nuclei, the fourth term is
the electron electron interaction and the fifth term is the interaction
between the nuclei. As the nuclei are 3 to 4 orders of magnitude heavier
than the electrons, we can apply the Born-Oppenheimer (BO)
approximation, where it is assumed that the electrons respond
instantaneously to the movements of the nuclei. This allows a separation
of the problem into the electronic structure problem and the nuclear
motion. Focusing on stationary solutions to the electronic structure
problem, the time independent electronic wave function
$\Phi = \Phi \left( \ec \right)$ satisfies the Schrödinger equation
$$E \Phi = \left\{ \hat\{T\}_e +\hat\{V\}_\{en\} + \hat\{V\}_\{ee\} \right\} \Phi ,$$
where $\hat\{T\}_e$ is the kinetic energy operator for the electrons,
$\hat\{V\}_\{en\}$ is the electron nucleus interaction and $\hat\{V\}_\{ee\}$ is
the electron electron interaction.

In density functional theory (DFT), the search for the $N$-particle
wavefunction is replaced by a search for the electron density
$n(\vec\{r\})$. This transformation reduces the problem from a $3N$ to a
3-dimensional problem. From a physical point of view, it is clear that
the ground state is uniquely defined by the external potential and the
number of electrons in the potential, since the external potential
specifies the Hamiltonian.

In 1964, Hohenberg and Kohn proved that the external potential is also
uniquely determined by the ground state density
$n(\vec\{r\})$.[@hohenbergkohn:1964] As the external potential determines
the Hamiltonian, the ground-state $N$-particle wavefunction and all
observables of the ground state are functionals of the density
$n(\vec\{r\})$. In particular, the ground state energy is a functional of
the density $E[n(\vec\{r\})]$.

Using the variational principle, it can be shown,[@kohn:nobel] that the
ground state density $n(\vec\{r\})$ minimizes the energy, $E[n(\vec\{r\})]$.
Following the constrained search approach proposed by Lieb and
Levy,[@Lieb:icqc:24; @levy:preva:26] the ground state energy may be
obtained by minimizing the energy over all possible wavefunctions with
the density $n(\vec\{r\})$, and then minimizing over all densities. The
ground state energy may then be written formally as $$\begin\{aligned\}
E_0=\min_\{n(\vec\{r\})\} E[n(\vec\{r\}))]&=\min_\{n(\vec\{r\})\} \left\{ F[n(\vec\{r\})]+\int v_\{ext\}(\vec\{r\}) n(\vec\{r\}) \textup\{d\}\vec\{r\} \right\} \label\{eq:Eafn\} \, ,
\end\{aligned\}$$ where $v_\{ext\}$ is the external potential and
$F[n(\vec\{r\})]$ is a universal but unknown functional obtained by
minimizing over all wavefunctions with density $n(\vec\{r\})$

$$\begin\{aligned\}
F[n(\vec\{r\})]=\min_\{\psi \rightarrow n(\vec\{r\})\} \left< \psi \right|\hat\{T\}_e + \hat\{V\}_\{ee\} \left| \psi\right>.
\end\{aligned\}$$

The energy functional may thus be expressed as $$\begin\{aligned\}
E[n(\vec\{r\})]=F[n(\vec\{r\})]+ V_\{ext\}[n(\vec\{r\})],  \label\{eq:HKfunctional\}
\end\{aligned\}$$ where
$V_\{ext\}[n(\vec\{r\})]=\int v_\{ext\}(\vec\{r\}) n(\vec\{r\}) \textup\{d\}\vec\{r\}$.
The first term is independent of the external potential and thus the
same for all systems of electrons interacting through the Coulomb
potential. The second term is easily evaluated and depends on the
system. The Hohenberg-Kohn theorem only proves that the energy is a
functional of the density. However, it does not prescribe a scheme for
obtaining this functional. A year later, Kohn and Sham developed an
approximate scheme for obtaining the functional [@kohnsham:1965] and
this will be discussed in the next section.

### The Kohn Sham Equations

The Kohn-Sham scheme is based on the observation that we can construct a
fictitious system based on non-interacting electrons in an effective
potential, $v_\{\rm eff\}$, that can match the density of the true system
consisting of interacting electrons. Then, by invoking the
Hohenberg-Kohn theorem, given the densities of the two systems are the
same, then the energy and other ground state properties are the same.
Through the construction of the effective potential, we need to ensure
that the electrons in the Kohn-Sham scheme have the exact same density
as the (real) interacting electrons

The total energy, in the Kohn-Sham scheme, is given by[@kohnsham:1965]
$$\begin\{aligned\}
E\left[n(\vec\{r\}) \right] &= T_s\left[n(\vec\{r\}) \right] +V_\{H\}\left[n(\vec\{r\}) \right] +E_\{xc\}\left[n(\vec\{r\}) \right] + V_\{ext\}\left[n(\vec\{r\}) \right]
\end\{aligned\}$$ where $T_s\left[n(\vec\{r\}) \right]$ is the kinetic
energy of the non-interacting electron gas with density $n(\vec\{r\})$,
and $V_\{H\}\left[n(\vec\{r\}) \right]$ is the Hartree energy, given by
$$\begin\{aligned\}
V_\{H\}\left[n(\vec\{r\})\right] &= \frac\{1\}\{2\} \int \int \frac\{ n(\vec\{r^\{\prime\}\})n(\vec\{r\}) \}\{ \left|\vec\{r\}-\vec\{r\}^\{\prime\}\right| \} \textup\{d\} \vec\{r\}^\{\prime\} \textup\{d\}\vec\{r\}.
\end\{aligned\}$$ There is an additional ingredient required in the
Kohn-Sham scheme to match the densities of the non-interacting system to
that of the interacting system. This term is called the exchange
correlation energy functional, $E_\{xc\}[n]$, which is introduced as a
correction that contains electron exchange and correlation. The exchange
correlation functional is not known exactly, and the strength of density
functional theory relies on the accuracy of the approximations to the
exchange correlation functional, $E_\{xc\}$.

Using the variational principle invoking the constraint that the number
of electrons needs to be conserved, we can derive the Kohn-Sham (KS)
equations. The KS equations are given by [@kohnsham:1965]
$$\begin\{aligned\}
\left[-\frac\{1\}\{2\} \nabla^2 + v_\{\rm eff\}\right]\phi_j(\vec\{r\})=\epsilon \phi_j(\vec\{r\}), \label\{eq:KSequation\}
\end\{aligned\}$$ where $\phi_j(\vec\{r\})$ represents the Kohn-Sham orbital
and the effective potential is $$\begin\{aligned\}
v_\{\rm eff\}(\vec\{r\})&=v_\{ext\}(\vec\{r\})+\int \frac\{ n(\vec\{r^\{\prime\}\})\}\{ \left|\vec\{r\}-\vec\{r\}^\{\prime\}\right| \} \textup\{d\} \vec\{r\}^\{\prime\}+v_\{xc\}(\vec\{r\}), \label\{eq:KSpotential\}
%\intertext\{the density is\}
%n(\vec\{r\})&=\sum_\{j=1\}^\{N\} \left| \phi_j(\vec\{r\}) \right|^2
\intertext\{and the exchange correlation potential is the functional derivative of $E_\{xc\}$\}
v_\{xc\}(\vec\{r\})&=\frac\{\delta E_\{xc\}\}\{\delta n(\vec\{r\})\},
\end\{aligned\}$$ $$\begin\{aligned\}
\left[-\frac\{1\}\{2\} \nabla^2 + v_\{ext\}(\vec\{r\})+\int \frac\{ n(\vec\{r^\{\prime\}\})\}\{ \left|\vec\{r\}-\vec\{r\}^\{\prime\}\right| \} \textup\{d\} \vec\{r\}^\{\prime\}+v_\{xc\}(\vec\{r\}) \right]\phi_j(\vec\{r\})=\epsilon_j \phi_j(\vec\{r\}),
\end\{aligned\}$$

$$\begin\{aligned\}
n(\vec\{r\}) = \sum_\{j \in occupied\} \left| \phi_j(\vec\{r\}) \right|^2.
\end\{aligned\}$$

The KS equations describe non-interacting electrons in a fictitious
potential that gives the same density as the interacting electrons.
Since the effective potential $v_\{\rm eff\}$ depends on $n(\vec\{r\})$, the
Kohn-Sham equations
[\[eq:KSequation\]](#eq:KSequation)\{reference-type="eqref"
reference="eq:KSequation"\} and
[\[eq:KSpotential\]](#eq:KSpotential)\{reference-type="eqref"
reference="eq:KSpotential"\} must be solved iteratively until a
self-consistent density is obtained.

### Exchange Correlation Functionals \{#dft:xc\}

In their original scheme, Kohn and Sham proposed a simple approximation
to the exchange correlation functional (xc-functional).[@kohnsham:1965]
They assumed that the exchange correlation energy at density
$n(\vec\{r\})$ is the same as that of a homogeneous electron gas with the
same density. This later became known as the local-density approximation
(LDA).

The exchange correlation energy, within the LDA, is given by
$$\begin\{aligned\}
E_\{xc\}^\{LDA\}=\int\epsilon_\{xc\}^\{hom\}(n(\vec\{r\}))n(\vec\{r\})\textup\{d\}\vec\{r\},
\end\{aligned\}$$ where $\epsilon_\{xc\}^\{hom\}(n(\vec\{r\}))$ is the energy of
the exchange correlation hole in the homogeneous electron gas of density
$n$. The local density approximation is, in principle, unique. Despite
its simplicity, LDA has had remarkable success in describing properties
such as lattice constants, vibrational frequencies and equilibrium
geometries of physical systems. Dissociation energies of molecules and
cohesive energies of solids are predicted within 10-20$\%$ and bond
geometries are often predicted within 1$\%$. The success of LDA is
partly rationalized by the fact that the exchange correlation hole is
normalized as in real systems. It is exact in the limit of high density
and the slowly varying limit.

Although LDA was often sufficiently accurate to describe properties of
solids, the wide-spread application of density functional theory did not
become commonplace until the development of the Generalized Gradient
Approximations (GGA). In a Generalized Gradient Approximation, the
exchange correlation energy depends on the gradient of the density as
well as the density. The exchange correlation energy is given by
$$\begin\{aligned\}
E_\{xc\}^\{GGA\}\left[ n(\vec\{r\})\right] &= \int \epsilon_\{xc\}^\{GGA\}\left( n(\vec\{r\}),\nabla n(\vec\{r\}) \right) \textup\{d\}\vec\{r\}.
\end\{aligned\}$$ However, unlike $\epsilon_\{xc\}^\{hom\}$, which is uniquely
defined, $\epsilon_\{xc\}^\{GGA\}$ is not unique. The choice of the
functional depends on the system and properties of interest.

However, both LDA and GGA have serious shortcomings and we present a
brief review of its failures to motivate the search for improvements. A
brief catalog of typical failures include:[@Albers:2009jq]

1.  Band structure predictions of metallic materials that are
    experimentally known to be insulating (*e.g.*, CoO and FeO),

2.  Absence of magnetism for materials that are magnetic (e.g., for many
    undoped high-temperature superconducting oxides) and vice versa
    (such as Pu),

3.  Band gaps that are much too small compared with experiment (*e.g.*,
    for many semiconductors),

When examining this list, it becomes clear that most of the problems
listed are associated with the spectral properties of the electronic
structure of a material. However, as explained carefully in the original
papers on LDA,[@hohenbergkohn:1964; @kohnsham:1965] this type of theory
is designed to minimize the total ground-state energy of the electrons
in a material as a functional of the spatial distribution of the number
density of electrons. Thus, the eigenvalues of the Kohn-Sham
equations[@kohnsham:1965] were never supposed to represent the actual
quasi-particle spectrum of electrons.

Nonetheless, because the eigenvalues often, in fact, are a reasonably
good representation of the spectral properties measured in experiments,
this identification is commonly made in practice. Hence, although this
has no justification, most attempts to improvements to density
functional theory beyond the GGA level are actually attempts to make
corrections to the eigenvalue spectra to bring it into better agreement
with various spectroscopic measurements that probe the quasi-particle
properties of the materials, such as optical and photoemission spectra.
Even the metal versus insulator problem involves this issue, since this
distinction depends upon knowing the quasi-particle spectral
distribution as a function of energy.
