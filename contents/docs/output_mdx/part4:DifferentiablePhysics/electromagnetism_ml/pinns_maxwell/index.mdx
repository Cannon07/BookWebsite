# Approximately Modeling Maxwell's Equations \{#chap:pinns_maxwell\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:qft_basics\]](#chap:qft_basics)\{reference-type="ref+label"
reference="chap:qft_basics"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

Maxwell's equations provide a classical model for complex interacting
electric and magnetic fields. Often times, simpler approximations to
Maxwell's equations suffice for modeling physical systems, but at times
the full detail of the equations may be required.

In particular, modeling complex optical systems design problems can
require solving Maxwell's equations directly which can be extremely
expensive. We can instead train a neural network to directly predict the
electric field and penalize deviations from Maxwell's equations as a
physics guided loss function [@lim2022maxwellnet].

## A Simplified Loss Function

For non-magnetic isotropic materials without electric or magnetic
current, we can consider the simplifed version of Maxwell's equations
given by

$$\begin\{aligned\}
\nabla \times \nabla \times E(r) - \kappa_0^2 \varepsilon_r(r) E(r) &= 0
\end\{aligned\}$$ Here $E$ is the electric field, $\varepsilon_r$ is the
relative electric permittivity distribution and $k_0$ is defined by
$$\begin\{aligned\}
k_0 &= \frac\{2 \pi\}\{\lambda\}
\end\{aligned\}$$ where $\lambda$ is the wavelength of light we consider.

Assume that we have a neural network that can predict the electric field
directly from an input geometry $x$ $$\begin\{aligned\}
f_\theta(r) \approx E(r)
\end\{aligned\}$$

This can be turned into a loss function

$$\begin\{aligned\}
\mathcal\{L\} &= | \nabla \times \nabla \times E(r) - \kappa_0^2 \varepsilon_r(r) E(r)|^2
\end\{aligned\}$$

We can then directly train $f_\theta$ to minimize this loss. The input
electric field can be represented by a discretized grid, in which case
$f_\theta$ can be a convolutional network.
