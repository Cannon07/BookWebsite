# Lorentz Group Equivariant Networks \{#chap:lorentz_equivariant\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:mpnn\]](#chap:mpnn)\{reference-type="ref+label"
reference="chap:mpnn"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

We have studied a number of group equivariant architectures. For
applications in high energy physics, it becomes very useful to have a
Lorentz group equivariant architecture [@bogatskiy2020lorentz]. This
architecture leverages the theory of finite dimensional representations
of the Lorentz group. The resulting equivariant architecture is able to
perform classification tasks from high energy physics with fewer
datapoints than comparable baselines.

## A Brief Review of Scattering

The electron-muon scattering element is given by

$$\begin\{aligned\}
    \mathcal\{M\}^2 &= \frac\{g_c^4[p_1\cdot p_3 +m_e^2][p_2\cdot p_4 + m_\{\mu\}^2]\}\{((p_1-p_2)^2 -m_\{\gamma\}^2)^2\}
\end\{aligned\}$$

## A Review of the Lorentz Group

The finite dimensional irreducible representations of the Lorentz group
are given by tensor products of representations of $SU(2)$.
$$\begin\{aligned\}
    T^\{(k,n)\} &= T^\{(k, 0)\} \oplus T^\{(0, n)\}
\end\{aligned\}$$

The proper orthochronous group $SO(1,3)^+$ is isomorphic to
$PSL(2, \mathbb\{C\})$

The Clebsch-Gordon product in this case is given by $$\begin\{aligned\}
    H: \bigoplus_\{k, n\} \tilde\{T\}^\{(k,n)\} \to T^\{(k_1, n_1)\} \otimes T^\{(k_2, n_2)\}
\end\{aligned\}$$

## A Review of Equivariance

The nonlinearity in our networks is given by the Clebsch-Gordon
coefficients. Suppose that $R_\{l_1\}$ and $R_\{l_2\}$ be irreducible
representations of $SU(2)$. We can write

$$\begin\{aligned\}
    R_\{l_1\} \otimes R_\{l_2\} &\sim \oplus_\{l\} \tilde\{R_l\}
\end\{aligned\}$$

The Clebsch-Gordon isomorphism is given by this map

$$\begin\{aligned\}
    B: \bigoplus_\{l=|l_1-l_2|\}^\{l_1+l_2\} \to R_\{l_1\} \times R_\{l_2\}
\end\{aligned\}$$

For $SU(2)$ define the canonical basis $e_\{l,m\}$. The product space
$R_\{l_1\}\otimes R_\{l_2\}$ has a canonical basis given by
$e_\{l_1,m_1\} \otimes e_\{l_2, m_2\}$. The Clebsch-Gordon coefficients are
the components of the map $$\begin\{aligned\}
    B: \tilde\{e\}_\{l,m\} \mapsto \sum_\{m_1, m_2\} B^\{l_1,m_1;l_2,m_2\}_\{l,m\} e_\{l_1,m_1\} \otimes e_\{l_2,m_2\}
\end\{aligned\}$$

The inverse transformation is given by

$$\begin\{aligned\}
    B^\{-1\}: R_\{l_1\} \otimes R_\{l_2\} \to \sum_\{l\} \tilde\{R\}_l
\end\{aligned\}$$ $$\begin\{aligned\}
    e_\{l_1, m_1\} \otimes e_\{l_2, m_2\} &= \sum (B^\{-1\})^\{l,m\}_\{l_1,m_1;l_2,m_2\} \tilde\{e\}_\{l,m\}
\end\{aligned\}$$ where $B^\{-1\} = B^T$.

## Lorentz Group Network

The inputs are the 4 momenta of $N_\{obj\}$ particles from some collision
event along with any associated scalar labels. The first layer is a
linear layer that produces output features that reside in an irreducible
representation for the Lorentz group.

We let $\textrm\{CG\}$ denote the Clebsch-Gordon operator. The update rule
is given by

$$\begin\{aligned\}
\mathcal\{F\}_i^\{(p+1)\} &= L_\{CG\}(\mathcal\{F\}^p)_i \\
&= W \cdot \left ( \mathcal\{F\}^p_i \oplus \textrm\{CG\}[\mathcal\{F\}^p_i]^\{\otimes 2\} \oplus \textrm\{CG\}[ \sum_j f(p_\{ij\}^2)p_\{ij\} \otimes \mathcal\{F\}^p_j] \right ) 
\end\{aligned\}$$

Here we have $p_\{ij\} = p_i - p_j$. The output is given by

$$\begin\{aligned\}
    w_\{out\} &= W_\{out\} \left ( \sum_i \mathcal\{F\}_i^\{(N_\{CG\})\} \right )
\end\{aligned\}$$

## Jet Tagging

High energy quarks emit cascading gluon emissions. The machine learning
challenge we face is classifying which quark emissions are interesting
and worthy of further study.
