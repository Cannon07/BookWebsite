# Gauge Equivariant Neural Networks \{#chap:gauge_equivariant_networks\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:ml_basics\]](#chap:ml_basics)\{reference-type="ref+label"
reference="chap:ml_basics"\},
[\[chap:grad_descent\]](#chap:grad_descent)\{reference-type="ref+label"
reference="chap:grad_descent"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

A gauge is an assignment of a local frame of reference to each point on
a manifold. A gauge transformation is a continuous set of
transformations, one for each point on a manifold. Gauge equivariant
convolutional networks[@cohen2019gauge] are a form of equivariant
network that satisfy a local equivariance to the gauge element at each
point on the manifold. Gauge equivariant networks have since found use
cases in physical systems with natural choice of gauge.

## Gauge Transformations

Let $M$ be a manifold. A gauge is given by a position dependent map
$w_p$. $$\begin\{aligned\}
    w_p : \mathbb\{R\}^d \to T_p M
\end\{aligned\}$$ This map determines a reference frame is given by
mapping the basis set $e_1,\dotsc, e_d$ through the gauge
$$\begin\{aligned\}
    w_p(e_1),\dotsc, w_p(e_d)
\end\{aligned\}$$ A local gauge transformation is given by a position
dependent linear transformation. $$\begin\{aligned\}
    g_p \in GL(d, \mathbb\{R\})
\end\{aligned\}$$ The change of frame/basis transformation is given by
$$\begin\{aligned\}
    w_p \mapsto w_p g_p
\end\{aligned\}$$ The gauge transformation provides a method for changing
the reference frame at each point. The new basis after a transformation
is given by $$\begin\{aligned\}
    w_p(e_1)g_p,\dotsc, w_p(e_d)g_p
\end\{aligned\}$$ Suppose we have some component vector
$v \in \mathbb\{R\}^d$. Under a change of basis, this vector transforms
$$\begin\{aligned\}
    v \mapsto g_p^\{-1\} v
\end\{aligned\}$$ so that the composition $$\begin\{aligned\}
(w_p g_p)(g_p^\{-1\} v) &= w_p v
\end\{aligned\}$$ remains unchanged. The group $G = GL(d, \mathbb\{R\})$ is
referred to as the structure group for the theory. In practice, we often
choose to restrict $G$ to $SO(d)$ so that the gauge transformation is
orthonormal.

The exponential map provides transport between different points on the
manifold. $$\begin\{aligned\}
    \textrm\{exp\}_p: T_p M \to M
\end\{aligned\}$$ Conceptually, this map takes a point in the tangent
space $T_p M$ and follows it for one (infinitesimal) unit of distance to
arrive at a new point on the manifold.

## Gauge Equivariant Convolution for Scalar Fields

We form an idealized mathematical model of a filter as a function

$$\begin\{aligned\}
    K: \mathbb\{R\}^d \to \mathbb\{R\}
\end\{aligned\}$$ The gauge $w_p$ lets us map $\mathbb\{R\}^d$ to $T_p M$.
Let $f: M \to \mathbb\{R\}$ be a signal on the manifold. Then we can
convolve filter $K$ against $f$ by the formula $$\begin\{aligned\}
    (K * f)(p) &= \int_\{\mathbb\{R\}^d\} K(v) f(\textrm\{exp\}_p w_p(v)) dv
\end\{aligned\}$$ What happens if we change the gauge? To make $K * f$
invariant to gauge transformations, we must have that $$\begin\{aligned\}
K(g^\{-1\} v) &= K(v)
\end\{aligned\}$$ If the structure group is $SO(d)$, then we are mandating
that filter $K$ must be rotationally invariant.

## General Gauge Equivariant Convolutions

$$\begin\{aligned\}
K(v): \mathbb\{R\}^\{C_\{in\}\} \to \mathbb\{R\}^\{C_\{out\}\}
\end\{aligned\}$$

$$\begin\{aligned\}
(K*f)(p) &= \int_\{\mathbb\{R\}^d\} K(v) \rho_\{in\}(g_\{p \leftarrow \exp v\}) f(\exp v) dv
\end\{aligned\}$$

The gauge is invariant if and only if $$\begin\{aligned\}
\forall g \in G, \  K(g^\{-1\}v) &= \rho_\{out\}(g^\{-1\})K(v)\rho_\{in\}(g)
\end\{aligned\}$$

## Efficiency Considerations

In the case where the gauge is chosen to be the icosahedron, we can
consider the gauge equivariant convolution as an approximation to a
spherical convolution.
