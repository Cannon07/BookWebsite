# Critical Behavior in the Ising model \{#chap:ising_critical\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:ising_model\]](#chap:ising_model)\{reference-type="ref+label"
reference="chap:ising_model"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In [\[chap:ising_model\]](#chap:ising_model)\{reference-type="ref+label"
reference="chap:ising_model"\}, we discussed the phase behavior of a
magnetic system by analyzing the exact 1D and mean-field approximation
of the Ising model. We saw that no phase transition occurs for the 1D
Ising model and the model exhibits a true phase transition for D $\geq$
2, which was argued by physical arguments and through the mean-field
approximation.

The $h-M$ phase diagram in a magnetic system was found to behave akin to
the $p-V$ phase diagram in vapor-liquid systems. In both systems, a
critical point exists that marks the onset of phase coexistence in the
system, i.e. for $T > T_c$, the system does not exhibit a phase
transition, and for $T < T_c$, phase transitions exist. Now, we discuss
the physical behavior near the critical point for both a magnetic system
and a liquid-vapor system.

## Critical point in vapor-liquid and magnetic systems

The fluctuations of the energy, density, and magnetization for a system
are found using various ensemble manipulations.

From the canonical ensemble, the variance of the energy is:
$$\begin\{aligned\}
\label\{Eq1\}
\langle (\delta E)^2\rangle &= \langle (E - \langle E \rangle)^2\rangle =  \langle E^\{2\} \rangle - \langle E \rangle^\{2\} \\
&= \frac\{1\}\{Q\}\left(\frac\{\partial ^\{2\}Q\}\{\partial \beta^\{2\}\}\right)\bigg|_\{V,N\} - \frac\{1\}\{Q^\{2\}\}\left(\frac\{\partial Q\}\{\partial \beta\}\right)^\{2\}\bigg|_\{V,N\}  \\
 &= \left(\frac\{\partial ^\{2\}\ln Q\}\{\partial \beta^\{2\}\}\right)\bigg|_\{V,N\} = \left(\frac\{\partial ^\{2\}\beta F\}\{\partial \beta^\{2\}\}\right)\bigg|_\{V,N\} = kT^\{2\}C_\{V\}
\end\{aligned\}$$

Thus connecting the energy fluctuations to $C_\{V\}$. The standard
deviation
$\sigma_\{E\} = \sqrt\{\langle E^\{2\} \rangle - \langle E \rangle^\{2\}\}$ for
energy fluctuations results in the characteristic magnitude of the
energy fluctuation per molecule in terms of the heat capcity per
molecule $c_\{V\} = \frac\{C_\{V\}\}\{N\}$ as: $$\begin\{aligned\}
\label\{Eq2\}
\frac\{\sigma_\{E\}\}\{N\} = \frac\{1\}\{N\}\sqrt\{NkT^\{2\}c_\{V\}\} = \sqrt\{\frac\{kT^\{2\}c_\{V\}\}\{N\}\} 
\end\{aligned\}$$

This calculation verifies that the average energy per molecule is a well
defined quantity with negligible fluctuations, provided that the heat
capacity does not diverge.

Similarly, the grand canonical ensemble for a one-component system
yields the molecule number variance to be:

$$\begin\{aligned\}
\label\{Eq3\}
\langle N^\{2\} \rangle - \langle N \rangle^\{2\} &= \left(\frac\{\partial ^\{2\}\ln \Xi\}\{\partial (\beta\mu)^\{2\}\}\right)\bigg|_\{\beta,V\} \\
&= \left(\frac\{\partial ^\{2\} (\beta pV)\}\{\partial (\beta\mu)^\{2\}\}\right)\bigg|_\{\beta,V\} \\
&= kT\left(\frac\{\partial \langle N \rangle\}\{\partial \mu\}\right)\bigg|_\{T,V\}
\end\{aligned\}$$

And noting the Gibbs-Duhem equation for a 1 component system
($d\mu=-sdT+vdp$) and $v = \frac\{V\}\{\langle N \rangle\}$, the variance in
$N$ can be written as: $$\begin\{aligned\}
\label\{Eq4\}
\langle N^\{2\} \rangle - \langle N \rangle^\{2\} = -kT\frac\{V\}\{v^\{3\}\} \left(\frac\{\partial v\}\{\partial p\}\right)\bigg|_\{T\}
\end\{aligned\}$$

Using the definition of molar density
$\rho=\frac\{1\}\{v\}=\frac\{\langle N \rangle\}\{V\}$ $$\begin\{aligned\}
\label\{Eq5\}
\langle \rho^\{2\} \rangle - \langle \rho \rangle^\{2\} = -\frac\{kT\}\{Vv^\{3\}\} \left(\frac\{\partial v\}\{\partial p\}\right)\bigg|_\{T\}
\end\{aligned\}$$

The condition for thermodynamic stability dictates that
$-\left(\frac\{\partial v\}\{\partial p\}\right)\bigg|_\{T\} > 0$, and if V
$\rightarrow\infty$, the density fluctuations in a stable system are
negligible. However, the condition
$\left(\frac\{\partial p\}\{\partial v\}\right)\bigg|_\{T\} \rightarrow 0$
dictates that the density fluctuations in the system diverge. Thus, the
limit of stability for a 1-component system, marked by
$\left(\frac\{\partial p\}\{\partial v\}\right)\bigg|_\{T\} = 0$, exhibits
wild density fluctuations.

As a system approaches the limit of stability for $T < T_c$, density
fluctuations become substantial, leading to the eventual formation of
the 2 coexisting phases (spinodal decomposition)
(Fig. [\[p-V\]](#p-V)\{reference-type="ref" reference="p-V"\}). As the
system approaches the critical point, the density fluctuations dominate
the physical behavior.

::: marginfigure
![image](figures/part2a/statistical_mechanics/critical_behavior_ising_model/fig1.png)\{width="\\linewidth"\}
:::

Rayleigh Scattering occurs when the length scale of density fluctuations
is comparable to the wavelength of light, where the local mismatch in
the index of refraction leads to light scattering
(Fig. [\[rayleigh\]](#rayleigh)\{reference-type="ref"
reference="rayleigh"\}).

The fluctuation in the magnetization for the Ising model is governed by:
$$\begin\{aligned\}
\label\{Eq6\}
\langle M^\{2\} \rangle - \langle M \rangle^\{2\} &= \left(\frac\{\partial ^\{2\}\log Q\}\{\partial (\beta h)^\{2\}\}\right)\bigg|_\{\beta J,N\} \\
&= \left(\frac\{\partial \langle M \rangle\}\{\partial (\beta h)\}\right)\bigg|_\{\beta J,N\} \\ 
&= N\left(\frac\{\partial m\}\{\partial (\beta h)\}\right)\bigg|_\{\beta J\}
\end\{aligned\}$$

::: marginfigure
![image](figures/part2a/statistical_mechanics/critical_behavior_ising_model/fig2.jpg)\{width="\\linewidth"\}
:::

As in the vapor-liquid system, the Ising model exhibits wild
fluctuations at the limit of metastability, marked by the condition:
$$\begin\{aligned\}
\frac\{\partial (\beta h)\}\{\partial M\}\bigg|_\{\beta J,N\} = 0 
\end\{aligned\}$$ In this case, the fluctuations are in the magnetization
rather than the density.

If we are far away from the critical point, the standard deviation in
the magnetization per site is:

$$\begin\{aligned\}
\label\{Eq7\}
\frac\{\sigma_\{M\}\}\{N\} = \sqrt\{\frac\{1\}\{N\}\left(\frac\{\partial m\}\{\partial (\beta h)\}\right)\bigg|_\{\beta J\}\}
\end\{aligned\}$$

Thus, suggesting that the magnetization is well-defined in the
thermodynamic limit $N \rightarrow \infty$. As we approach the critical
point, the role of fluctuations dominates the system thermodynamics, as
we will proceed to discuss.

## Critical behavior for the Ising model

We discuss the critical behavior for the Ising model from 3 different
perspectives.

-   Using Monte Carlo simulation, demonstrate the physical behavior of
    the Ising model as $T \rightarrow T_c$

-   Mean-field approximation using our treatment from the previous
    lecture

-   Introduce basic concepts in renormalization group theory

To illustrate these concepts, focus on the 2-dimensional Ising model on
a square lattice. The analytical solution for the 2D Ising model
[@Onsager1944] shows that the critical temperature is $T_c = 2.269 J/k$
and the magnetization scales as $M \sim N(T-T_c)^\{\frac\{1\}\{8\}\}$. This
result acts as a useful basis for comparison for the methods that we
discuss today and next time.

## Monte Carlo Simulation

Exact analytical solutions for many problems are frequently both
difficult to find and unwieldy to use if they can be solved. Computer
simulations are particularly useful for quantifying behavior when
analytical results cannot be found and for visualizing physical
phenomena to aid understanding. Here, we introduce Monte Carlo
simulation as a method to visualize the physical behavior near the
critical point.

Consider the Ising model on a 2-dimensional square lattice. The
governing equations for the canonical ensemble are: $$\begin\{aligned\}
P_\{\mu\} = \frac\{1\}\{Q\}\exp(-\beta E_\{\mu\}) 
\end\{aligned\}$$

where: $$\begin\{aligned\}
Q = \sum_\{\mu\}\exp(-\beta E_\{\mu\}) 
\end\{aligned\}$$

$\mu$ represents a microscopic configuration of the system (e.g. a set
of spin values s$_i$ for the Ising model).

Rather than explicitly solving the partition function, we employ a
computer simulation technique called Monte Carlo simulation. First, we
choose a random starting configuration. Then, we cycle many times
through the following Metropolis algorithm:

1.  Starting from state $\mu$, randomly create a new trial state $\mu '$

2.  The probability $\alpha$ of choosing this new state is given by:
    $$\begin\{aligned\}
        \alpha = \frac\{P_\{\mu '\}\}\{P_\{\mu\}\} = \frac\{\frac\{1\}\{Q\}\exp(-\beta E_\{\mu '\})\}\{\frac\{1\}\{Q\}\exp(-\beta E_\{\mu\})\} = \exp(-\beta (E_\{\mu '\} - E_\{\mu\}))
        
    \end\{aligned\}$$

3.  If $E_\{\mu '\} < E_\{\mu\}$, always change the state from $\mu$ to
    $\mu '$

4.  If $E_\{\mu '\} > E_\{\mu\}$, select a random number $A$ between 0 and
    1, and only change the state from $\mu$ to $\mu '$ if $A < \alpha$

In order to properly explore phase space, the system need to undergo
many random changes. Since the distribution is not known a priori, it is
necessary to establish metrics for whether you have run the simulation
sufficiently long. For the Ising model, the simplest method for choosing
a trial state is to randomly choose a spin and flip it. Then, calculate
the energy change, and determine if you select the new move.

::: marginfigure
![image](figures/part2a/statistical_mechanics/critical_behavior_ising_model/fig3.png)\{width="\\linewidth"\}
:::

There are many caveats to Monte Carlo simulations. Care has to be taken
when determining whether you have fully sampled the distribution.
Adaptive methods for randomly selecting trial states that do not result
in too many instances of rejections or too small of moves must be
established. Calculating certain averages can be difficult when the
simulation needs to explore rare regions of phase space to accurately
evaluate the average (e.g. the Helmholtz free energy). Therefore, one
must ensure the moves are able to get out of deep energy wells.
Importantly, it must be ensured that the simulation are not biased to
any region of phase space (for satisfying the ergodic hypothesis).

Monte Carlo simulation is generally very adaptable to different models
and is very simple to implement. An example is shown in
Fig. [\[mc\]](#mc)\{reference-type="ref" reference="mc"\}.

## Mean-field approximation

In an earlier chapter, we showed that the equation of state for the
mean-field approximation to the Ising model is: $$\begin\{aligned\}
\label\{Eq8\}
m = \tanh(\beta h + \beta J zm) = \tanh(\bar\{h\} + Km) 
\end\{aligned\}$$

The mean-field critical point is at $\bar\{h\}$ = 0 and $K_c = 1$, thus we
can write $K = T_c/T$, where $T_c = 2J/k$ for a 2D square lattice. Just
below $T = T_c$ and $h = 0$, on expanding $m$ near $m=0$, we get:
$$\begin\{aligned\}
\label\{Eq9\}
m = \tanh \left( \frac\{T_c\}\{T\}m \right) \approx \frac\{T_c\}\{T\}m - \frac\{1\}\{3\}\left( \frac\{T_c\}\{T\}\right)^3m^3 \rightarrow m \approx \pm \sqrt\{\frac\{3\}\{T_c\}\}(T_c-T)^\{1/2\}
\end\{aligned\}$$

To find the fluctuations in the magnetization near $T = T_c$, we find:
$$\begin\{aligned\}
\label\{Eq10\}
\frac\{\partial m\}\{\partial \bar\{h\}\} &= [1 - \tanh^\{2\} (\bar\{h\} + Km)][1 + K\frac\{\partial m\}\{\partial \bar\{h\}\}]  \\
&=  \frac\{1-m^\{2\}\}\{1-K+Km^\{2\}\}
\end\{aligned\}$$

For $T > T_c$, we have $m=0$. Therefore: $$\begin\{aligned\}
\frac\{\partial m\}\{\partial \bar\{h\}\} =  \frac\{1\}\{1-K\} \sim \frac\{1\}\{T-T_c\} 
\end\{aligned\}$$ And for $T < T_c$, we have: $$\begin\{aligned\}
\frac\{\partial m\}\{\partial \bar\{h\}\} =  \frac\{1-3+3/K\}\{1-K+K(3-3/K)\}  \sim \frac\{1\}\{K-1\} \sim \frac\{1\}\{T_c-T\} 
\end\{aligned\}$$

Thus, the mean-field approximation to the Ising model predicts the
fluctuations in the magnetization to diverge near the critical
temperature as: $$\begin\{aligned\}
\langle M^\{2\} \rangle - \langle M \rangle^\{2\} \sim \frac\{N\}\{|T-T_c|\}
\end\{aligned\}$$

For $T = T_c$ ($K = 1$) and $h \neq 0$, expand $m$ about $m = 0$ to get:
$$\begin\{aligned\}
m \simeq (\bar\{h\}+m) - 1/3(\bar\{h\}+m)^\{3\} \rightarrow m \simeq 3^\{1/3\}\bar\{h\}^\{1/3\} - \bar\{h\} \sim h^\{1/3\}
\end\{aligned\}$$

The deviation of the mean-field approximation from the exact result lies
in the neglect of correlations near the critical point, thus the
mean-field approximation is best far from the critical point.

For a vapor-liquid system governed by a mean-field theory (e.g. van der
Waal's equation of state), the critical behavior is: $$\begin\{aligned\}
\rho_c - \rho &\sim (T_c-T)^\{1/2\},\,\,\,\langle \rho^\{2\} \rangle - \langle \rho \rangle^\{2\} \sim \frac\{1\}\{|T-T_c|\} \sim \kappa_T  \\
\rho - \rho_c &\sim (p-p_c)^\{1/3\}
\end\{aligned\}$$

Which shows a direct correspondence between $m-\rho$ and $h-p$. The
critical behavior of the Ising model and of other related thermodynamic
systems reflects the underlying impact of correlations on the
thermodynamic behavior. The mean-field approximation does not properly
account for these correlations, so we employ a technique called
*renormalization group theory* to account for spatial correlations which
will be discussed in future chapters.
