# Gaussian Integrals \{#chap:gaussian_integrals\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:manifold\]](#chap:manifold)\{reference-type="ref+label"
reference="chap:manifold"\}\
**Difficulty Level:** \*\*\*\

------------------------------------------------------------------------

Let's start by considering the Gaussian integral

$$G = \int_\{-\infty\}^\infty e^\{-\frac\{1\}\{2\}x^2\} dx$$

How do we evaluate this integral? The trick that's usually presented is
to square the integral then do a change of basis to radial coordinates.

$$\begin\{aligned\}
    G^2 &= \left ( \int_\{-\infty\}^\infty e^\{-\frac\{1\}\{2\}x^2\} dx \right )^2 \\
    &= \int_\{-\infty\}^\infty \int_\{-\infty\}^\infty e^\{-\frac\{1\}\{2\}(x^2 + y^2)\} dx dy \\
\end\{aligned\}$$ Let's apply the change of variable $$\begin\{aligned\}
    x &= r \cos \theta \\
    y &= r \sin \theta \\
\end\{aligned\}$$ We can then compute the determinant of the Jacobian of
this change of variables as $$\begin\{aligned\}
\det \mathcal\{J\} &= \det \begin\{pmatrix\}
    \frac\{\partial x\}\{\partial r\} & \frac\{\partial x\}\{\partial \theta\} \\
    \frac\{\partial y\}\{\partial r\} & \frac\{\partial y\}\{\partial \theta\} \\
    \end\{pmatrix\} \\
    &= \det \begin\{pmatrix\}
    \cos\theta & -r\sin \theta \\
    \sin \theta & r \cos \theta \\
\end\{pmatrix\} \\
&= r \\
\end\{aligned\}$$ This means in practice that we transform the volume
element $dx dy$ into $r dr d\theta$. Let's plug this back into our
integral to obtain $$\begin\{aligned\}
    G^2 &= \int_\{0\}^\{2\pi\} \int_\{0\}^\infty e^\{-\frac\{1\}\{2\}r^2\} r dr d\theta\\
    &= 2 \pi \int_\{0\}^\infty e^\{-\frac\{1\}\{2\}r^2\} r dr \\
\end\{aligned\}$$ Let's apply the change of variable $u = \frac\{1\}\{2\}r^2$.
Then $du = r dr$ to obtain $$\begin\{aligned\}
    G^2 &= 2 \pi \int_0^\infty e^\{-u\} du \\
    &= 2 \pi
\end\{aligned\}$$

Thus it follows that $G = \sqrt\{2 \pi\}$. So far, this doesn't look too
interesting. What does this integral calculation have to do with
integral programs? Well one consideration here is that now that we have
this closed form calculation for this simple Gaussian integral, anytime
we see this same Gaussian integral in an integral program, the
underlying compiler can just replace it with the constant
$\sqrt\{2 \pi\}$. This isn't terribly interesting; how often are we likely
to see just this constant?

Things start to look a little more interesting when we start to evaluate
slightly more general Gaussian integrals.

Let's now consider the slightly more general integral

$$\int_\{-\infty\}^\{\infty\} e^\{-\frac\{1\}\{2\} ax^2\}$$

We can take the same tack as above and compute

$$\begin\{aligned\}
    G^2 &= \left ( \int_\{-\infty\}^\infty e^\{-\frac\{1\}\{2\}ax^2\} dx \right )^2 \\
    &= \int_\{-\infty\}^\infty \int_\{-\infty\}^\infty e^\{-\frac\{1\}\{2\}a(x^2 + y^2)\} dx dy \\
\end\{aligned\}$$

Let's apply the same change of variables as above.

$$\begin\{aligned\}
    G^2 &= \int_\{0\}^\{2\pi\} \int_\{0\}^\infty e^\{-\frac\{1\}\{2\}ar^2\} r dr d\theta\\
    &= 2 \pi \int_\{0\}^\infty e^\{-\frac\{1\}\{2\}ar^2\} r dr \\
\end\{aligned\}$$

Let's apply the change of variable $u = \frac\{1\}\{2\}ar^2$. Then
$du = ar dr$ to obtain $$\begin\{aligned\}
    G^2 &= 2 \pi \int_0^\infty \frac\{e^\{-u\}\}\{a\} du \\
    &= \frac\{2 \pi\}\{a\}
\end\{aligned\}$$ Thus it follows that $G = \sqrt\{\frac\{2\pi\}\{a\}\}$. Let's
now evaluate a slightly more complex integral again.

$$\int_\{-\infty\}^\{\infty\} e^\{-\frac\{1\}\{2\}ax^2 + Jx\} dx$$

Here $J$ is another constant. To solve this integral, we will work to
complete the square on the quadratic $-\frac\{1\}\{2\}ax^2 + Jx$

$$\begin\{aligned\}
    -\frac\{1\}\{2\}ax^2 + J x &= -\frac\{1\}\{2\}a \left (x^2 -2\left (\frac\{J\}\{a\} \right ) x \right) \\
    &= -\frac\{1\}\{2\}a \left (x^2 -2\left (\frac\{J\}\{a\} \right ) x + \left ( \frac\{J\}\{a\} \right )^2 \right ) + \frac\{J^2\}\{2a\} \\
    &= -\frac\{1\}\{2\}a \left (x -\left (\frac\{J\}\{a\} \right ) \right )^2 + \frac\{J^2\}\{2a\} \\
\end\{aligned\}$$

Let's apply the change of variable $y = x + \frac\{J\}\{a\}$. Then we see

$$\begin\{aligned\}
    -\frac\{1\}\{2\} a x^2 + J x &= -\frac\{1\}\{2\} a y^2 + \frac\{J^2\}\{2a\}
\end\{aligned\}$$ Let's plug this back into the source integral
$$\begin\{aligned\}
    G &= \int_\{-\infty\}^\{\infty\} e^\{-\frac\{1\}\{2\}ax^2 + Jx\} \\
    &= \int_\{-\infty\}^\{\infty\} e^\{-\frac\{1\}\{2\}ay^2 + J^2/2a\} dy \\
    &= \sqrt\{\frac\{2 \pi\}\{a\}\} e^\{J^2/2a\}
\end\{aligned\}$$
