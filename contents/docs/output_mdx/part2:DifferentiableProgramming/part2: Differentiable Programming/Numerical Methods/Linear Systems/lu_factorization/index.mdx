# LU Factorization \{#chap:lu_factorization\}

------------------------------------------------------------------------

\
**Prerequisites:**
[\[chap:linear_systems\]](#chap:linear_systems)\{reference-type="ref+label"
reference="chap:linear_systems"\}\
**Difficulty Level:** \*\*\

------------------------------------------------------------------------

In this chapter, we will learn about the LU factorization technique for
matrices and its mathematical underpinnings. We will explain how these
methods can be used to solve linear algebraic equations.

## LU Factorization \{#lu-factorization\}

Consider a system of three equations defined as $Ax = b$ where $A$ is
the coefficient matrix. This can be rearranged to get $$\begin\{aligned\}
 \label\{eq:Eq1\}
Ax - b = 0
\end\{aligned\}$$ Suppose that Eq.$\ref\{eq:Eq1\}$ could be expressed as an
upper triangular system, then $$\begin\{aligned\}
\begin\{bmatrix\}
u_\{11\} & u_\{12\} & u_\{13\} \\ 
0 & u_\{22\} & u_\{23\} \\ 
0 & 0 & u_\{33\}
\end\{bmatrix\}
\left \{
\begin\{tabular\}\{c\}
$x_1$ \\
$x_2$ \\
$x_3$
\end\{tabular\}
\right \}
= \left \{
\begin\{tabular\}\{c\}
$d_1$ \\
$d_2$ \\
$d_3$
\end\{tabular\}
\right \}
\end\{aligned\}$$ $$\begin\{aligned\}
 \label\{eq:Eq2\}
Ux - d = 0
\end\{aligned\}$$ Consider a lower diagonal matrix with 1's on the
diagonal such that when premultiplied with
Eq.[\[eq:Eq2\]](#eq:Eq2)\{reference-type="ref" reference="eq:Eq2"\}, we
get Eq.[\[eq:Eq1\]](#eq:Eq1)\{reference-type="ref" reference="eq:Eq1"\}.
$$\begin\{aligned\}
L =
\begin\{bmatrix\}
1 & 0 & 0 \\ 
l_\{21\} & 1 & 0 \\ 
l_\{31\} & l_\{32\} & 1
\end\{bmatrix\}
\end\{aligned\}$$ $$\begin\{aligned\}
 \label\{eq:Eq3\}
L(Ux - d) = Ax - b
\end\{aligned\}$$ Therefore from rules of matrix multiplication
$$\begin\{aligned\}
\begin\{gathered\}
LU = A\\
Ld = b
\end\{gathered\}
\end\{aligned\}$$

::: marginfigure
![image](figures/part1b/lu_factorization/lufactorization_0.png)
:::

As shown in Figure [\[fig:1\]](#fig:1)\{reference-type="ref"
reference="fig:1"\} a two step strategy is formed to obtain solutions:

1.  *LU factorization step*. $A$ is decomposed into lower $L$ and upper
    $U$ triangular matrices.

2.  *Substitution step*. $L$ and $b$ are used to evaluate intermediate
    matrix $d$ which is then used with $U$ to evaluate $x$ as in
    Eq.[\[eq:Eq2\]](#eq:Eq2)\{reference-type="ref" reference="eq:Eq2"\}.

``` \{.python language="python"\}
def lu_factorization(A: $\mathbb\{R\}^\{N \times N\}$):
  L = eye(N)
  U = A
  for i = 0:N-1
    for j = i+1:N
      ratio = U[j,i]/U[i,i]
      U[j,i:N] = U[j,i:N]-ratio*U[i,i:N]
      L[j,i] = ratio
  i=U\(L\b)
  
```

::: marginfigure
Output:

    L = 1.0000         0         0
       -0.6250    1.0000         0
             0   -0.4364    1.0000
             
    U = 8.0000   -5.0000         0
             0    6.8750   -3.0000
             0         0    9.6909%

    i = 0.8630
        0.3809
       -0.1689
:::
